% !TEX root = z_output/_AlgGeoQuals.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%% 80 characters %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[11pt]{article}
\input{../macros.tex}
\usepackage{makeidx}

\def\excludeversion#1{\includeversion{#1}}

\excludeversion{I.1 Affine Varieties}
\excludeversion{I.2 Projective Varieties}
\excludeversion{I.3 Morphisms}
\excludeversion{I.4 Rational Maps}
\excludeversion{I.5 Nonsingular Varieties}
\excludeversion{I.6 Nonsingular Curves}
\excludeversion{I.7 Intersections in Projective Space}

\excludeversion{II.1 Sheaves}
\excludeversion{II.2 Schemes}
\excludeversion{II.3 First Properties of Schemes}
\excludeversion{II.4 Separated and Proper Morphisms}
\excludeversion{II.5 Sheaves of Modules}
\includeversion{II.6 Divisors}
\includeversion{II.7 Projective Morphisms}

\usepackage{multicol}
\makeatletter
\renewenvironment{theindex}
  {\if@twocolumn
      \@restonecolfalse
   \else
      \@restonecoltrue
   \fi
   \setlength{\columnseprule}{0pt}
   \setlength{\columnsep}{10pt}% I CHANGED THIS from 35pt
   \begin{multicols}{3}[\section*{\indexname}]
   \markboth{\MakeUppercase\indexname}%
            {\MakeUppercase\indexname}%
   \thispagestyle{plain}
   \setlength{\parindent}{0pt}
   \setlength{\parskip}{0pt plus 0.3pt}
   \relax
   \let\item\@idxitem
   \small}% I ADDED THIS
  {\end{multicols}\if@restonecol\onecolumn\else\clearpage\fi}
\makeatother


\makeindex
\newcommand{\indexThmCode}{}
\newcommand{\Index}[1]{\index{#1}#1}
\newcommand{\indexThm}[1]{\index{Hartshorne!Theorems, etc.!#1}}
\newcommand{\Entry}[3][notcustom]{\Bullet
\ifthenelse{\equal{#1}{}}{}
{
\ifthenelse{\equal{#1}{notcustom}}{\index{#2}}{\index{#1}}
}
 \textbf{#2:}&#3}


\begin{document}
\begin{I.1 Affine Varieties}
\section*{Hartshorne I.1 --- Affine Varieties}
\index{Hartshorne!I.1: Affine Varieties}
\begin{itemise}
\item A nonempty open subset of an irreducible\index{irreducible} space is
irreducible and dense.\index{dense}
\item The closure of an irreducible subspace is irreducible.
\item For $\fraka\subset A$, $I(Z(\fraka))=\sqrt\fraka$, by the
Nullstellensatz.\index{Nullstellensatz} $Z(I(Y))=\overline Y$.
\item Closed sets correspond to radical\index{radical} ideals. A closed set is
irreducible\index{irreducible} \Iff it corresponds to a prime\index{prime}
ideal. (A topological space is irreducible if it is not the union of two proper
closed subsets).
\item Affine varieties\index{variety} correspond to finitely generated
$k$-algebras which are domains.
\item In a noetherian\index{noetherian!space} topological space, closed sets are
uniquely finite unions of irreducible ones.
\item The dimension\index{dimension} of a space is one less than the length of
the longest chain of distinct irreducible closed subsets. This coincides with
the dimension of the coordinate ring.
\item \textbf{Theorem 1.8A:}\indexThm{I.1.08A} For $k$ a field, $B$ a f.g.\
$k$-algebra which is a domain:\\ \Bullet $\dim(B)$ is the \Index{transcendence
degree} of $K(B)/k$. \ \ \Bullet $\text{height}\,\frakp+\dim B/\frakp=\dim B$.
\item \textbf{Theorem 1.11A:}\indexThm{I.1.11A}
(Hauptidealsatz)\index{Hauptidealsatz} Let $A$ be noetherian, and $f\in A$ be
neither zero divisor nor unit. Then if $\scrI$ is the set of prime ideals
containing $f$, any minimal ideal in $\scrI$ in fact has height one.

\INDENT\emph{Interpretation if $A$ is a UFD} --- $Z(f)$ can be written uniquely
as a union of hypersurfaces $Z(f_i)$. Any maximal closed irreducible subset of
$Z(f)$ has codimension one in $\Spec A$ --- the only larger irreducible is all
of $A$.
\item \textbf{Proposition 1.12A:}\indexThm{I.1.12A} A noetherian domain $A$ is a
\Index{UFD} \Iff every prime ideal of height one is principal.

\INDENT\emph{Interpretation} --- a noetherian domain $A$ is a \Index{UFD} \Iff
every maximal proper closed irreducible subset of $\Spec A$ is a hypersurface,
the zero set of one element.

\item A variety $Y\in \A^n$ has dimension $n-1$ \Iff it is a
\Index{hypersurface}: $Z(f)$ for some nonconstant irreducible $f$. The same
holds for a projective variety in $\PP^n$ of dimension $n-1$.
\end{itemise}
\end{I.1 Affine Varieties}
\begin{I.2 Projective Varieties}
\section*{Hartshorne I.2 --- Projective Varieties}
\index{Hartshorne!I.2: Projective Varieties}
\begin{itemise}
\item To talk about $\PP^n$, introduce graded ring $S=k[x_0,\ldots,x_n]$, zero
sets of homogeneous polynomials,\index{homogeneous} and of homogeneous ideals.
\item Constructed homeomorphism $U_i\to \A^n$. Note that if $Y$ is a
(quasi)-projective variety, it is covered by the (quasi)-affine varieties $Y\cap
U_i$.
\item Closed subsets of $\PP^n$ correspond to homogeneous radical ideals of $S$
not equal to $S_+$, the irrelevant\index{irrelevant} maximal ideal.
\item Given a variety $Y\subset A^n$, the closure $\overline Y$ of $Y$ in
$\PP^n$ is called the projective closure.\index{projective closure} Its ideal is
generated by $\beta(I(Y))$, where $\beta:A\to S$ maps $x_i$ to $x_i/x_0$.
\item Have $d$-uple embedding\index{d-uple} $\PP^n\to\PP^N$ sending
$[x_0:\cdots:x_n]$ to all the degree $d$ monomials. The image of the 2-uple
embedding $\PP^2\to\PP^5$ is called the Veronese surface\index{Veronese
surface}. The image of the $3$-uple embedding of $\PP^1$ in $\PP^3$ is the
twisted cubic\index{twisted cubic} curve.
\item Have the \Index{Segre embedding} $\PP^r\times\PP^s\to\PP^{rs+r+s}$. The
\Index{quadric surface} in $\PP^3$, defined by $xy=zw$, is the Segre embedding
$\PP^1\times\PP^1\to\PP^3$.
\end{itemise}
\end{I.2 Projective Varieties}
\begin{I.3 Morphisms}
\section*{Hartshorne I.3 --- Morphisms}
\index{Hartshorne!I.3: Morphisms}
\begin{itemise}
\item A function $f:Y\to k$ is regular\index{regular function} if it is locally
a quotient of (homogeneous in projective case) polynomials of the same degree
with nonvanishing denominator. A regular function is continuous.
\item A morphism\index{morphism!of varieties} of varieties is a continuous map
$f:X\to Y$ such that if $\phi:V\to k$ is a regular function for open $V\subset
Y$, then $\phi\circ f$ is regular of $f^{-1}(V)$. That is, $f$ must map the
sheaf $\calO_Y$ of \Index{regular functions} on $Y$ into $\calO_X$ (as
subsheaves of the sheaves of discontinuous functions).
\item For $p\in Y$, have the \Index{local ring} $\calO_{p,Y}$, the stalk of
$\calO_Y$ at $p$. The \Index{function field} is the local ring at the generic
point --- here we should define it to be the direct limit of the $\calO_Y(U)$
over all nonempty open subsets $U$ of $Y$. Elements of the function field are
called \Index{rational functions}. Note that by restriction, we have injections
$\calO_Y(Y)\to\calO_{p,Y}\to K(Y)$.
\item Note that the function field of a product is the quotient field of the
tensor product of the function fields.
\item \textbf{Theorem 3.2:}\indexThm{I.3.02} For $Y$ affine,
$\calO_Y(Y)=A(Y)$. $\calO_{p,Y}\cong A(Y)_{\frakm_p}$, and $\dim\calO_{p,y}=\dim
Y$. $p\mapsto\frakm_p$ gives a bijection between points of $Y$ and
\Index{maximal ideals} of $A(Y)$. Finally, $K(Y)\cong A(Y)_{(0)}$, so that
$K(Y)$ is a finitely generated \index{field extension}extension of $k$, of
\Index{transcendence degree} $\dim Y$.
\item \textbf{Theorem 3.4:}\indexThm{I.3.04}
For $Y$ projective, $\calO_Y(Y)=k$, $\calO_{p,Y}=S(Y)_{(\frakm_p)}$, and
$K(Y)=S(Y)_{((0))}$. Here we are using \Index{degree zero localization}s.
\item \textbf{Proposition 3.5:}\indexThm{I.3.05}
There is a natural isomorphism, for varieties $X$ and affine varieties $Y$,
$\Hom(X,Y)\overset{\sim}{\to}\Hom(A(Y),\calO(X))$. In fact, if $\calV$ is the
category of varieties over $k$, and $\calD$ is the category of finitely
generated integral domains over $k$, there is a contravariant \Index{adjunction}
$\calO:\calV\longleftrightarrow\calD^\op:\Spec$, which induces an isomorphism of
categories between $\calD^\op$ and the full subcategory of $\calV$ consisting of
affine varieties.
\end{itemise}
\end{I.3 Morphisms}
\begin{I.4 Rational Maps}
\section*{Hartshorne I.4 --- Rational Maps}
\index{Hartshorne!I.4: Rational Maps}
\begin{itemise}
\item Morphisms which agree on a nonempty open subset of a variety are equal.
\item A \Index{rational map} $X\to Y$ is an equivalence class of morphisms
defined on a nonempty open subset of $X$. A rational map is \Index{dominant} if
its image is dense (i.e.\ for some (equivalently any) choice of open subset). A
\Index{birational} map is a rational map with an inverse as rational maps. A
variety is simply \Index{rational} if it is birational to a projective space.
\item The complement of a hypersurface $Z(f)\subset \A^n$ is a hypersurface
$Z(x_{n+1}f)\subset \A^{n+1}$ with coordinate ring $k[x_1,\ldots,x_n]_f$.
\item A variety has a \Index{base} for its topology consisting of open affine
subsets.
\item \textbf{Theorem 4.4:}\indexThm{I.4.04}
A dominant rational map induces a map of function fields, and the resulting
correspondence is bijective, giving an contravariant equivalence of categories
from ``varieties with DRMs'' to ``finitely generated field extensions of
$k$''.\item \textbf{Corollary 4.5:}\indexThm{I.4.05}
Varieties are birational \Iff they have isomorphic open subsets \Iff they have
isomorphic function fields.
\item The blowup is defined --- to blow up $0\in Y\subset A^n$, use composite
$\phi:X\to\A^n\times\PP^n\to\A^n$, where $X$ is defined by equations
$x_iy_j=x_jy_i$. Take $\widetilde Y=\overline{\phi^{-1}(Y-0)})$.
\item Rational functions and more generally rational maps have a maximum
\Index{domain of definition}.
\item If $p\in X$ and $q\in Y$ are such that $\calO_{p,X}$ and $\calO_{q,Y}$ are
isomorphic $k$-algebras, then there is a birational map $X\to Y$ taking $p$ to
$q$.
\item If $X\subset\PP^n$ is a projective variety with $\dim X<n-1$, then for
some $p\notin X$, projection from $p$ induces a birational morphism from $X$ to
it's image. Repeating this process, we end up with a \Index{hypersurface} in
$\A^{\dim X+1}$ birational to $X$.
\end{itemise}
\end{I.4 Rational Maps}
\begin{I.5 Nonsingular Varieties}
\section*{Hartshorne I.5 --- Nonsingular Varieties}
\index{Hartshorne!I.5: Nonsingular Varieties}
\begin{itemise}
\item If $Y\in\A^n$ is an affine variety with ideal generated by
$f_1,\ldots,f_t$, then $Y$ is \Index{nonsingular} at $p\in Y$ if the rank of the
\Index{Jacobian} $\|(\partial f_i/\partial x_i)(p)\|$ is $n-\dim Y$. (It may be
lower).
\item If $A$ is a \emph{noetherian} local ring, we say $A$ is a \Index{regular
local ring} if $\dim_{A/\frakm}\frakm/\frakm^2=\dim A$. Note that $\geq$ holds
always.
\item \textbf{Theorem 5.1:}\indexThm{I.5.01}
$Y\in\A^n$ is nonsingular at $p$ \Iff $\calO_{p,Y}$ is a regular local ring.
Thus the notion of nonsigularity is intrinsic and extends to all varieties.
\item \textbf{Theorem 5.3:}\indexThm{I.5.03}
For any variety $Y$, the set $\Sing Y$ of singular points is a proper closed
subset.
\item To study very local behaviour, we take \Index{completion}s. The completion
of a local ring $(A,\frakm)$ is $\hat A:=\varprojlim
A/\frakm^n=\varprojlim\{\cdots\rightarrow A/\frakm^3\rightarrow
A/\frakm^2\rightarrow A/ \frakm\}$. 
\item \textbf{Theorem 5.4A:}\indexThm{I.5.04A} Suppose $A$ is noetherian. $\hat
A$ is local with maximal ideal $\frakm A$, and $A\to\hat A$ is injective. For
finitely generated $A$-modules $M$, $M\otimes_A\hat A$ is the $\frakm$-adic
completion of $M$. $\dim \hat A=\dim A$ and $\hat A$ is regular \Iff $A$ is
regular.
\item $p\in X$ and $q\in Y$ are \Index{analytically isomorphic} if
$\hat\calO_{p,X}\cong\hat\calO_{q,Y}$ as $k$-algebras.
\item \textbf{Theorem 5.5A:}\indexThm{I.5.05A} (\Index{Cohen Structure Theorem}) 
The only complete regular local ring of dimension $n$ containing a field $k$ is
the power series ring in $n$ variables over $k$. In particular, any two
nonsingular points of the same dimension are analytically isomorphic.
\item \textbf{Theorem 5.7A:}\indexThm{I.5.07A} (\Index{elimination theory}) 
Given homog.\ polynomials $f_1,\ldots,f_r\in k[x_0,\ldots,x_n]$ with
indeterminate coefficients $a_{ij}$, we want to know when they have a common
root other than $(0,0,\ldots,0)$. There a polynomials
$g_1,\ldots,g_t\in\Z[a_{ij}]$, homogeneous in the coefficients of each $f_i$
separately, such that there is a common nonzero root for the $f_i$ \Iff there is
a common root for the $g_t$.
\item \textbf{Exercise 5.4:} We define the intersection multiplicity at
$P\in\A^2$ of the curves $C_1$ and $C_2$ defined by $f,g\in k[x,y]$ to be the
length of the $\calO_P$-module $\calO_P/(f,g)$. This makes sense, for we are
pulling back:
\[\xymatrix{
C_1\cap C_2\ar[r]\ar[d]\ar[rd]&C_2\ar[d]\\
C_1\ar[r]&\A^2
}\]
We have a closed immersion $C_1\cap C_2\cofibration \A^2$, and the length of the
$\calO_P$-module $\calO_{C_1\cap C_2,P}$ measures the multiplicity at $P$.
However, $\calO_{C_1\cap C_2,P}=\calO_{C_1,P}\otimes_{\calO_P}\calO_{C_2,P}$,
and $\calO_{C_1,P}=\calO_P/f$, so that $\calO_{C_1\cap C_2,P}=\calO_P/(f,g)$ as
desired.

\INDENT In higher dimensions, this is not the correct formula for the
intersection multiplicity --- there are some derived functors which get
involved. Maybe the intersection itself should really get `derived'.
\end{itemise}
\end{I.5 Nonsingular Varieties}
\begin{I.6 Nonsingular Curves}
\section*{Hartshorne I.6 --- Nonsingular Curves}
\index{Hartshorne!I.6: Nonsingular Curves}
\begin{itemise}
\item There is a unique nonsingular projective curve in each birational
equivalence class of curves. For each finitely generated field extension $K/k$
of transcendence degree one, there is then a unique nonsingular projective curve
$C_K$ with function field $K$.
\item Moreover, and homomorphism $K_2\to K_1$ over $k$ is represented by a
morphism $C_{K_1}\to C_{K_2}$.
\item Let $K$ be a field and $G$ be a totally ordered abelian group. A
\Index{valuation} on $K$ with values in $G$ is homomorphism $v:K^\times\to G$
such that for all nonzero $x,y$: $v(x+y)\geq\min\{v(x),v(y)\}$. The
\Index{valuation ring} of $v$ is then $\{0\}\cup v^{-1}({\geq0})$, a local ring
whose units are $\ker v$. The valuation ring always has quotient
field $K$. Call $v$ a valuation of $K/k$ if $v(k^\times)=\{0\}$.
\item If $A,B$ are local rings in a field $K$, then $B$ dominates $A$ if
$A\subseteq B$ and $\frakm_B\cap A=\frakm_A$.
\item \textbf{Theorem 6.1A:}\indexThm{I.6.01A}
A local ring $R$ contained in a field $K$ is a valuation ring of $K$ \Iff it is
a maximal local ring w.r.t.\ domination. Every local ring inside $K$ is
dominated by some valuation ring of $K$.
\item \textbf{Theorem 6.2A:}\indexThm{I.6.02A}
Let $A$ be a noetherian local domain of dimension one. TFAE: 
\begin{enumerate}\squishlist
\item $A$ is a \Index{discrete valuation ring} (i.e.\ comes from a valuation
with values in $\Z$);
\item $A$ is \Index{integrally closed} (i.e.\ \Index{normal});
\item $A$ is a \Index{regular local ring} (implies 2, even in higher
dimensions);
\item The maximal ideal of $A$ is principal.
\item $A$ is a UFD (see next point).
\end{enumerate}
\item Note that is always the case that a \Index{regular local ring} is
\index{normal}normal. In fact:
\[\text{Regular local ring}\implies\text{UFD}
\implies\text{normal/integrally closed}\]
Note that being a \Index{UFD} is a natural demand for smoothness --- an obvious
example of local failure to be factorial arises at the origin of the cone
$xy=z^2$. Note that this example is normal!
\item A \Index{Dedekind domain} is an integrally closed noetherian domain of
dimension one. As being integrally closed\index{integrally closed!is local
property} is a local property, every localization of a Dedekind domain is a DVR.
\item For $K/k$ a finitely generated extension of transcendence degree one, let
$C_K$\index{abstract nonsingular curve} be the set of all discrete valuation
rings of $K/k$.
\item Given a point $y$ on a nonsingular curve $Y$ with function field $K$,
there's an \emph{injective} function $Y\to C_K$ given by $p\mapsto\calO_{p}\in
C_K$.
\item \textbf{Theorem 6.5:}\indexThm{I.6.05}
For any $x\in K$, all but finitely map $R\in C_K$ contain $x$.

\INDENT\emph{Interpretation} --- $x\notin R$ means that $x$ will have a pole at
$R$ (as an element of the `curve' $C_K$). As $K$ is one dimensional, each $x$
has only finitely many poles.
\item \textbf{Corollary 6.6:}\indexThm{I.6.06}
Any DVR of $K/k$ is the local ring of a point on a nonsingular affine curve.
\item Make $C_K$ a topological space using the cofinite topology. If $U\subseteq
C_K$ is open, define $\calO(U):=\cap_{P\in U}R_P$. An element $f\in\calO(U)$
defines a function $U\to k$ by taking $P$ to the image of $f$ in the residue
field of $\calO_P$, which must be $k$ by 6.6.
\item $f\in\calO(U)$ can be recovered from its function $U\to k$, as if $0\neq
f\mapsto 0$, $f\in\frakm_p$ for all $p$, so $f^{-1}\notin R_p$ for all $p$,
contradicting 6.5, as there must be infinitely many $R_p$ by 6.6. By 6.5, any
$f\in K$ is a regular function on some open $U$. Thus the quotient field of
$C_K$ is $K$. 
\item An \Index{abstract nonsingular curve} is an open subset of $C_K$ with the
induced topology and sheaf of regular functions. A morphism of such is a
continuous map such that regular functions pull back to regular functions.
\item \textbf{Proposition 6.7:}\indexThm{I.6.07} Every nonsingular
quasi-projective curve is isomorphic to an abstract nonsingular curve.
\item \textbf{Theorem 6.9:}\indexThm{I.6.09} $C_K$ is isomorphic to a 
nonsingular projective curve.
\item \textbf{Corollary 6.10:}\indexThm{I.6.10} Every abstract nonsingular curve
is isomorphic to a quasi-projective curve. Every nonsingular quasi-projective
curve is isomorphic to an open subset of a nonsingular projective curve.
\item \textbf{Corollary 6.11:}\indexThm{I.6.11} Every curve is birationally
equivalent to a nonsingular projective curve.
\item \textbf{Corollary 6.12:}\indexThm{I.6.12} The following categories are
equivalent:
\begin{enumerate}\squishlist
\item[(i)] Nonsingular projective curves and \emph{dominant morphisms};
\item[(ii)] Quasi-projective curves and \emph{dominant rational maps};
\item[(iii)] function fields of dimension 1 over $k$ and $k$-homomorphisms.
\end{enumerate}
\item \textbf{Proposition 6.8:}\indexThm{I.6.08} Let $X$ be a nonsingular curve,
$p\in X$, let $Y$ be a projective variety, and let $\phi:X-\{p\}\to Y$ be a
morphism. Then there is a unique extension of $\phi$ to a morphism $X\to Y$.
{\small (This fails if $Y$ is not projective, or if $\dim X>1$.)}
\item Using proposition 6.8, one can show that every automorphism of $\PP^1$ is
in $\PGL(1)$.
\end{itemise}
\end{I.6 Nonsingular Curves}
\begin{I.7 Intersections in Projective Space}
\section*{Hartshorne I.7 --- Intersections in Projective Space}
\index{Hartshorne!I.7: Intersections in $\PP^n$}
\end{I.7 Intersections in Projective Space}
\begin{II.1 Sheaves}
\section*{Hartshorne II.1 --- Sheaves}
\index{Hartshorne!II.1: Sheaves}
\begin{itemise}
\item A \Index{presheaf} on $X$ is a contravariant functor from the category of
open subsets of $X$ to abelian groups. There is some contention (Bjorn) as to
whether to require $\emptyset\mapsto0$. It's a \Index{sheaf} if:
\begin{enumerate}\squishlist
\item[(3)] If $U$ is open with open cover $\{V_i\}$, and $s\in\scrF(U)$ has
$s|_{V_i}=0$ for all $i$, then $s=0$.
\item[(4)] If $s_i\in\scrF(V_i)$ agree on overlaps, then they glue (uniquely).
\end{enumerate}
Any subpresheaf of a sheaf has (3). Any presheaf maps to the sheaf of its
\Index{discontinuous sections}, and the kernel of this map consists of sections
which violate (3).
%\item A presheaf is a \Index{sheaf} if ``being zero can be determined using an
%open cover'' and if ``gluing sections is possible''.
\item A morphism of sheaves is an isomorphism \Iff it is an isomorphism on the
stalks.
\item The presheaf kernel, cokernel and image are exactly as one would hope.
\item Given a presheaf $\scrF$ there is a universal morphism $\scrF\to\scrF^+$
into a sheaf $\scrF^+$ called the \Index{sheafification}. $\scrF$ and $\scrF^+$
have the same stalks. The sections of $\scrF^+(U)$ can be viewed as sections of
$\cup_{p\in U} \scrF_p\downarrow U$ which are locally induced by sections of
$\scrF$. If $\scrF$ is a sub-presheaf of a sheaf $\scrG$, then
its sheafification is the intersection of all subsheaves of $\scrG$ containing
$\scrF$.
\item Given a morphism of sheaves $\scrF\to\scrG$, the kernel is a sheaf. The
image need not be a sheaf, so we define the \Index{sheaf image} to be the
smallest subsheaf of $\scrG$ containing the presheaf image of $\scrF$. We are
thus already equipped to discuss exact sequences of sheaves, by demanding that
kernel equals \emph{sheaf} image.
\item If $\scrF'\subset\scrF$ is an inclusion of sheaves, the \Index{quotient
sheaf} $\scrF/\scrF'$ is defined to be the sheafification of the quotient
presheaf. The quotient presheaf has (3) but not (4), as if
$[f_i]\in\scrF(V_i)/\scrF'(V_i)$ agree on $V_i\cap V_j$, this only means that
they $f_i-f_j\in \scrF'(V_i\cap V_j)$, and this element may not extend to
$\scrF'(V_i\cup V_j)$.

\INDENT Sections of $(\scrF/\scrF')(U)$ are equivalence classes of collections
of sections of the presheaf on coverings of $U$ which agree on overlaps.
\item A sequence of sheaves is exact\index{exact sequence} \Iff it is exact on
the stalks.
\item Constructing new sheaves from old, given $f:X\to Y$:
\begin{itemize}\squishlist
\item 
\makebox[3cm][l]{\textbf{\Index{direct image}:} }
\makebox[1cm][r]{$f_*:$\ }$\Sheaves_X\to\Sheaves_Y$,
\makebox[3cm][r]{$(f_*\scrF)(V):=$}
$\scrF(f^{-1}(V))$.
\item
\makebox[3cm][l]{\textbf{\Index{inverse image}:} }
\makebox[1cm][r]{$f^{-1}:$\ }$\Sheaves_Y\to\Sheaves_X$,
\makebox[3cm][r]{$(f^{-1}\scrG)(U):=$}
$\varinjlim_{V\supseteq f(U)} \scrG(V)$.\\
If $f$ is the inclusion of a subspace, we call $f^{-1}\scrG$ the 
\Index{restriction} of $\scrG$ to $X$, denoted $\scrG|_{X}$.
Note that there are maps $f^{-1}f_*\scrF\to \scrF$ and $\scrG\to f_*f^{-1}\scrG$
which are easy to write down, and are the counit and unit of an adjunction
$f^{-1}:\Sheaves_Y\longleftrightarrow\Sheaves_X:f_*$.
\end{itemize}
\item Given an inverse system of sheaves on $X$, the inverse limit
presheaf\index{inverse limit sheaf} is in fact a sheaf, and is the inverse limit
in the category of sheaves on $X$.
\item \textbf{\Index{extension by zero}:} Let $i:Z\to X$ be the inclusion of a
closed subset, and $j:U\to X$ be the inclusion of its complement.
\begin{itemize}\squishlist
\item \textbf{{from sheaf on closed subset}:} Suppose $\scrF$ is a sheaf
on $Z$. Then its extension by zero is simply $i_*\scrF$.
\item \textbf{{from sheaf on open subset}:} Suppose $\scrF$ is a sheaf on
$U$. Then its extension by zero is the sheafification $j_!\scrF$ of
$j_!^-\!\scrF\in\Presheaves_X$, where
$j^-_!\!\scrF(V):=
\begin{cases}\scrF(V),&V\subseteq U\\0,&\text{otherwise}.\end{cases}$ \\
The stalks on $U$ are unchanged, and are zero on $Z$. $j^-_!\!\scrF$ satisfies
(3) and so embeds in its discontinuous sections, which are identified with the
discontinuous sections of $\scrF$. The sheafification consists of sections of
$\scrF$ whose support (as a subset of $U$) has closure in $X$ not intersecting
$Z$. In this sense, there are fewer sections of $j_!\scrF$ than of $\scrF$.
\end{itemize}
\item \textbf{\Index{sheaf Hom}:} Given $\scrF,\scrG\in\Sheaves_X$, define
$\shfHom(\scrF,\scrG)\in\Sheaves_X$ by $U\mapsto \Hom(\scrF|_U,\scrG|_U)$.
\item The functor $\Gamma(U,\DASH)$ is left exact from $\Sheaves_X\to \AbGp$. It
is exact on short exact sequences where the kernel is \Index{flasque}.
\item The \Index{support} of a section of a sheaf is the set of points at which
it is nonzero in the stalk. This is a \emph{closed} set!
\end{itemise}
\end{II.1 Sheaves}
\begin{II.2 Schemes}
\section*{Hartshorne II.2 --- Schemes}
\index{Hartshorne!II.2: Schemes}
\begin{itemise}
\item Define $\Spec A$\index{Spec} to be the set of prime ideals of $A$. For
$\fraka\subseteq A$ any ideal, let $V(\fraka)$ be the set of prime ideals which
contain $\fraka$. These sets are the closed subsets of $\Spec A$. Note that
$V(\fraka)\subseteq V(\frakb)$ \Iff $\sqrt\fraka\supseteq\sqrt\frakb$. Note that
$\frakp\in V(f)$ \Iff $f$ vanishes at $\frakp$, that is, $f$ maps to zero in the
\Index{residue field} $A_\frakp/\frakp A_\frakp\cong (A/\frakp)_{(0)}$ at
$\frakp$.

\INDENT Define a sheaf $\calO$ on $\Spec A$ by assigning $\frakp$ the stalk
$A_\frakp$, and requiring that a section be locally a quotient of elements of
$A$. Together, this data is the \Index{spectrum} of $A$.
\item \textbf{Proposition 2.2:}\indexThm{II.2.02} Let $D(f)$ be the complement
of $V(f)$. Then the ring $\calO(D(f))$ is isomorphic to $A_f$. In particular,
$\Gamma(\calO)\cong A$.
\item A \Index{ringed space} is a pair $(X,\calO_X)$ of a space and a sheaf of
rings. A morphism\index{morphism!of ringed spaces} of ringed spaces is a pair
$(f,f^\#)$ of a map $f:X\to Y$ and a map $f^\#:\calO_Y\to f_*\calO_X$. A
\Index{locally ringed space} is a ringed space wherein the stalks are all local
rings. A morphism of locally ringed spaces is a morphism of ringed spaces where
the maps on stalks are local\index{local homomorphism} (i.e.\ the preimage of
the maximal ideal is the maximal ideal).
\item \textbf{Proposition 2.3:}\indexThm{II.2.03} Each spectrum is a locally
ringed space, and there is a natural bijective correspondence between
homomorphisms $A\to B$ and morphisms $\Spec B\to\Spec A$ of locally ringed
spaces.
\item An \Index{affine scheme} is any ringed space isomorphic to the spectrum of
a ring. A \Index{scheme} is a locally ringed space with an open cover of affine
schemes.
\item Suppose $S$ is a graded ring. Let $\Proj S$\index{Proj} be the set of all
homogeneous prime ideals which do not contain all of $S_+$. If $\fraka$ is a
homogeneous ideal of $S$, let $V(\fraka)$ be the set of elements of $\Proj S$
which contain $\fraka$. The $V(\fraka)$ are the closed sets.

\INDENT Define a sheaf $\calO$ on $\Proj S$ by assigning $\frakp$ the stalk
$S_{(\frakp)}$, the degree zero localization, and requiring that a section be
locally a quotient of homogeneous elements of $S$ of the same degree.
\item \textbf{Proposition 2.5:}\indexThm{II.2.05} Let $D_+(f)$ be the complement
of $V(f)$ for any homogeneous $f$. Then the ringed space
$(D_+(f),\calO(D_+(f)))$ is isomorphic to $\Spec A_{(f)}$, so that $\Proj S$ is
a scheme.
\item \textbf{Proposition 2.6:}\indexThm{II.2.06} Let $k$ be an algebraically
closed field. There is a natural fully faithful functor
$\Varieties(k)\to\Schemes(k)$. For any variety $V$, its topological space is
homeomorphic to the subspace of closed points of $t(V)$, and its sheaf of
regular functions is obtained by restricting the structure sheaf of $t(V)$.

\textbf{Proposition 4.10:}\indexThm{II.4.10} The image of $t$ is exactly the set
of quasi-projective integral schemes over $k$. The image of the set of
projective varieties is the set of integral projective schemes. If $V$ is a
projective variety with homogeneous coordinate ring $S$, then $t(V)\cong \Proj
S$.
\item A scheme is reduced\index{reduced scheme} if $\calO_X(U)$ has no
\Index{nilpotent} elements for every open subset $U$, or equivalently if
$\calO_{X,P}$ has no nilpotent elements for every $P\in X$.

\INDENT \emph{Interpretation of being reduced} --- we need only interpret this
on an affine scheme. Suppose that $n\in R$ is a nilpotent. Then as
$n\in\sqrt0=\bigcap\frakp$, the global section $n$ of $\calO_{\spec R}$ maps to
zero in the residue field at every point $\frakp$. Thus the nilpotents are
exactly the global sections which are zero when viewed as a function from $\Spec
R$ to its residue fields.

\INDENT Given a scheme $X$, there is a universal
reduced scheme $X_\textup{red}$ mapping to $X$. The map is a homeomorphism on
spaces.
\item The functor $\Spec$ is right adjoint to global sections, 
$\Gamma:\Schemes\longleftrightarrow\Rings^\op:\Spec$, i.e.:
\[\Hom_{\Schemes}(X,\Spec A)\overset{\cong}{\to}
\Hom_{\Rings}(A,\Gamma(\calO_X)).\]
In particular $\Spec\Z$ is terminal in $\Schemes$.
\item To give a map $\Spec K\to X$, it is equivalent to choose a point of $x$
and specify an inclusion $k(x)\to K$, the \Index{residue field}
$\calO_x/\frakm_x$ at $x$.% Thus the $K$-points\index{K-points} of $X$, the
%morphisms $\Spec K\to X$, capture which points can be defined over $K$.
\item For $x\in X$, define the Zariski \Index{tangent space} at $x$ to be the
$k(x)$-vector space $T_x$ dual to $\frakm_x/\frakm_x^2$. Let
$D=k[\epsilon]/\epsilon^2$ be the ring of \Index{dual numbers} over $k$. If $X$
is a scheme over $k$, then to give a $k$-morphism $\Spec D\to X$ is to give a
point $x\in X$ \Index{rational} over $k$ (i.e.\ $k(x)=k$), and an element of
$T_x$. In particular, rational points map to rational points under $k$-maps.
\item Every non-empty irreducible closed subset $Z$ of $X$ has a unique
\Index{generic point}, a point $\zeta$ such that $\{\zeta\}^-=Z$.
\item A scheme is called \Index{quasi-compact} if its underlying topological
space is so. Any affine scheme is quasi-compact.
\item A space is \Index{noetherian} \Iff all of its closed subsets are
quasi-compact. The spectrum of a noetherian ring is a noetherian topological
space.
\item \labelRIGHTHERE{mapsofprojs}$\Proj S$ is empty \Iff $\Rad(S)\supseteq
S_+$. Given a map $\phi:S\to T$ of graded rings, we only get a map $f:U\to \Proj
S$, where $U$ is the set of homogeneous prime ideals in $\Proj T$ whose preimage
is not all of $S_+$. $f$ only depends on the $\phi_d$ for $d\gg0$, so can be an
isomorphism even if $\phi$ is not.
\item Suppose $\phi:A\to B$ corresponds to $f:Y=\Spec B\to \Spec A=X$. Then:

\Bullet $\phi$ is injective \Iff $f^\#:\calO_X\to f_*\calO_Y$ is injective, in
which case $f$ is dominant.

\Bullet $\phi$ is surjective \Iff $f$ is a homeomorphism onto a closed subset
and $f^\#$ is surjective.
\end{itemise}
\end{II.2 Schemes}
\begin{II.3 First Properties of Schemes}
\section*{Hartshorne II.3 --- First Properties of Schemes}
\index{Hartshorne!II.3: First Properties}
\begin{itemise}
\item A scheme $X$ is:\\
\begin{tabular}{p{.2\textwidth}p{.7\textwidth}}
\Entry{connected}{if its topological space is connected.}\\
\Entry{reduced}{if none of the rings $\calO_X(U)$ (equiv.\ $\calO_{X,p}$) have
nilpotent elements.}\\
\Entry{integral}{if $\calO_X(U)$ is a domain for all open $U\subseteq X$.\\&
\Iff it is reduced and irreducible.}\\
\Entry[locally noetherian]{locally noeth.}{if it can be covered by open affine
$\Spec A_i$ with $A_i$ noetherian rings.\\{\ \ \small(a local property)}&
\Iff whenever $\spec A$ is an open subscheme of $X$, $A$ is
noetherian\indexThm{II.3.02} \textbf{(3.2)}}\\
\Entry{noetherian}{if it is locally noetherian and quasi-compact.}
\end{tabular}
%\begin{itemize}\squishlist
%\item \makebox[3cm][l]{\textbf{\Index{connected}:}}
%if its topological space is connected.
%\item \makebox[3cm][l]{\textbf{\Index{irreducible}:}}
%if its topological space is irreducible.
%\item \makebox[3cm][l]{\textbf{\Index{reduced}:}}
%if none of the rings $\calO_X(U)$ (equiv.\ $\calO_{X,p}$) have nilpotent
%elements.
%\item \makebox[3cm][l]{\textbf{\Index{integral}:}}
%if $\calO_X(U)$ is a domain for all open $U\subseteq X$.
%
%\makebox[3cm][l]{\textbf{}}
%\Iff it is reduced and irreducible.
%\item \makebox[3cm][l]{\textbf{\Index{locally noeth.}:}}
%if it can be covered by open affine $\Spec A_i$ with $A_i$ noetherian rings.
%
%\makebox[3cm][l]{\textbf{}}
%\Iff whenever $\spec A$ is an open subscheme of $X$, $A$ is
%noetherian\indexThm{II.3.02} \textbf{(3.2)}
%\item \makebox[3cm][l]{\textbf{\Index{noetherian}:}}
%if it is locally noetherian and quasi-compact.
%\end{itemize}
\item A morphism $X\to Y$ of schemes is:\\
\begin{tabular}{p{.2\textwidth}p{.7\textwidth}}
\Entry{locally of finite type}{if $Y$ can be covered by open affine $V_i=\spec
B_i$ such that each $f^{-1}(V_i)$ can be covered by $\spec A_{ij}$ making
$A_{ij}$ a finitely generated $B_i$-algebra.}\\
\Entry[finite type]{of finite type}{if only finitely many $A_{ij}$ are required
for each $i$ in the previous.\\&$\iff$ locally of finite type and
quasi-compact.}\\
\Entry{quasi-compact}{if $Y$ can be covered with open affines each with compact
preimage.}\\
\Entry{finite}{if $Y$ can be covered by open affine $V_i=\spec B_i$ such that
each $f^{-1}(V_i)$ is affine equal to $\spec A_{i}$, making $A_{i}$ a finitely
generated $B_i$-module.\\&$\implies$ proper; closed, and quasi-compact,
separated (and affine).}\\
\Entry{affine}{if $Y$ can be covered by open affine $V_i=\spec B_i$ with
$f^{-1}(V_i)$ affine.\\&$\implies$ quasi-compact and separated.}\\
\Entry{separated}{if $\Delta:X\to X\times_Y X$ is a closed immersion.}\\
\Entry{univ.\ closed}{if any base extension $f':X'\to Y'$ is closed.}\\
\Entry{proper}{if it is separated, of finite type and universally closed.}
\end{tabular}
All of these properties are local on the base --- the requirements end up
satisfied for \emph{any} open cover $V_i$.
\item An \index{immersion!open}open immersion is simply the inclusion of an open
subscheme.
\item A \index{immersion!closed}closed immersion is a morphism $f:Y\to X$ such
that $f$ is a homeomorphism onto a closed subset of $X$, and $f^\#:\calO_X\to
f_*\calO_Y$ is surjective. Note that the surjectivity condition simply says that
any function on $Y$ should lift to a function on $X$ \emph{locally}.

\INDENT A \Index{closed subscheme} of a scheme $X$ is an equivalence class of
closed immersions, where closed immersions $f_i:Y_i\to X$ are equivalent if
there is an isomorphism $Y_1\to Y_2$ making the triangle commute.

\INDENT For $X$ affine, the closed subsets are the $V(\fraka)$. There is a
different \index{closed subscheme!of affine scheme}closed subscheme structure on
$V(\fraka)$ for each $\fraka'$ with $\sqrt{\fraka}=\sqrt{\fraka'}$. In fact,
every closed subscheme arises in this way.
\item Given a scheme $X$ and closed subset $Y$, there is a `smallest' closed
subscheme structure for $Y$, the \index{closed subscheme!reduced induced}reduced
induced closed subscheme structure. We construct this when $X$ is affine and
glue. If $X=\Spec A$ and $Y=V(\fraka)$, take $\Spec (X/\sqrt\fraka)\to\Spec X$.
{\small (Note that $\sqrt\fraka$ is the largest ideal available, so there are no
redundant functions in the structure. Allowing a function in
$\sqrt\fraka\setminus\fraka$ allows a nilpotent section.)}
\item There is a \Index{fibre product} $X\times_SY$ of schemes. If $X=\Spec A$,
$Y=\Spec B$, and $S=\Spec R$, then $X\times_SY$ is $\Spec(A\otimes_R B)$.
\item The \Index{fibre} of $f:X\to Y$ over a point $y\in Y$ is $X_y:=X\times
_Y\Spec k(y)$. Moreover, we have \Index{base extension}
$\Schemes_S\to\Schemes_{S'}$ whenever we have a morphism $S'\to S$. The
following types of morphisms are stable under base extension (not exhaustive):
\begin{itemize}\squishlist
\item those of finite type
\item closed and open immersions
\item separated and proper
\end{itemize}
\item Integral schemes are very unstable under base extension --- it is easy to
give examples where irreducibility ($xy=t$) and reducedness ($ty=x^2$) are not
preserved.
\item Given a morphism $f:Z\to X$, there is a universal closed subscheme $Y$ of
$X$ through which $f$ factors, called the scheme theoretic
image\index{image!scheme theoretic} --- if $f$ also factors through $Y'$, then
$Y\to X$ factors as $Y\to Y'\to X$.
\item Given a surjection $\phi:S\to T$ of graded rings, the open subset $U$ of
earlier (page \pageref{mapsofprojs}), is all of $\Proj T$, and we have a closed
immersion $f:\Proj T\to\Proj S$. If $S$ is a polynomial ring over $S_0$, every
closed subscheme\index{closed subscheme!of $\PP_A^n$} comes from a unique
homogeneous \emph{saturated}\index{saturated ideal} ideal of $S$.
{\small(An ideal $I$ of $S=S_0[x_1,\ldots,x_n]$ has saturation $\overline
I:=\{s\in S\,:\,x^n_is\in I\text{\ for all $i$, some $n$}\}$.)}
\item Properties of morphisms of \Index{finite type}:
\begin{enumerate}\squishlist
\item if $f:X\to Y$ has finite type, $\Spec B\subset Y$ and $\Spec A\subset
f^{-1}(\Spec B)$ are open subsets, then $A$ is \emph{always} a finitely
generated $B$-algebra.
\item A closed immersion is of finite type. 
\item A quasi-compact open immersion is of finite type. 
\item A composition of two morphisms of finite type is of finite type. 
\item If $X$ and $Y$ have finite type over $S$, so does $X\times_SY$. 
\item If $X\to Y\to Z$ is of finite type, then $X\to Y$ is locally of finite
type. {\small(Use 1.)}
\item If $X\to Y$ has finite type, and $Y$ is \Index{noetherian}, then $X$ is
noetherian.
\end{enumerate}
\item \textbf{\index{noetherian!induction}Noetherian induction:} if a property
$\scrP$ of closed subsets of a noetherian space $X$ holds for $Z$ whenever it
holds for all proper closed subsets of $Z$, then it holds for all closed subsets
of $X$.
\end{itemise}
\end{II.3 First Properties of Schemes}
\begin{II.4 Separated and Proper Morphisms}
\section*{Hartshorne II.4 --- Separated and Proper Morphisms}
\index{Hartshorne!II.4: Separated \& Proper}
\begin{itemise}
\item A morphism $X\to Y$ is \Index{separated} if $\Delta:X\to X\times_Y X$ is a
closed immersion.
\item Any morphism of affine schemes is separated, as $A\otimes_BA\to A$ is
surjective.
\item It's enough that $\im(\Delta(X))$ is a closed subset of $X\times_YX$.\\
{\small(It's all local on $Y$. Surjectivity on sheaves is local on $X$, so we
can pretend $X$ is affine to get a closed immersion. As $X\to X\times_YX\to X$
is the identity, $\Delta$ is always a homeomorphism onto its image.)}
\item \textbf{Theorem 4.3:}\indexThm{II.4.03} (\index{valuative
criterion!separatedness}valuative criterion of separatedness) Let $f:X\to Y$ be
any morphism where $X$ is noetherian. Then $f$ is separated \Iff the following
condition holds. Suppose $R\to K$ is the inclusion of a valuation ring into its
field of fractions. Then there is at most one lifting (dotted) in any commuting
diagram of the following form:
\[\xymatrix@C=0cm{
(0)\,\makebox[-.05cm][l]{$\in$}\ar@{|->}[d]&&\Spec K\ar[rr]\ar[d]&
\qquad \qquad &X\ar[d]^f\\
\xi\,\makebox[-.05cm][l]{\,\,$\in$}&&\Spec R\ar[rr]\ar@{-->}[rru]&&Y
}\]

\INDENT\emph{Interpretation} --- If a map to $Y$ can be lifted to $X$ at the
generic point $\xi$, as everything in $\Spec R$ is so close to $\xi$, any
extension of this lift to all of $\Spec R$ must be unique.
\item \textbf{Theorem 4.7:}\indexThm{II.4.07} (\index{valuative
criterion!properness}valuative criterion of properness) Let $f:X\to Y$ be
a morphism \textbf{of finite type}, where $X$ is noetherian. Then $f$ is proper
\Iff there is \textbf{exactly} one lifting (dotted) in:
\[\xymatrix@C=0cm{
(0)\,\makebox[-.05cm][l]{$\in$}\ar@{|->}[d]&&\Spec K\ar[rr]\ar[d]&
\qquad \qquad &X\ar[d]^f\\
\xi\,\makebox[-.05cm][l]{\,\,$\in$}&&\Spec R\ar[rr]\ar@{-->}[rru]&&Y
}\]
\emph{Interpretation} --- As before, except that as $X\to Y$ is proper, a
lift should exist.
\begin{exmp*}[Exercise 4.1]
{A finite morphism is proper.}\footnote{We should just note that finite
morphisms are closed under base extension, closed, separated and of finite
type.}
\begin{proof}
As properness is local on the base, we can check this for a map of affine
schemes induced by a finite ring homomorphism $B\to A$. Now there's a
correspondence between dashed arrow in the diagrams:
\[\xymatrix{
\Spec K\ar[r]\ar[d]&\spec A\ar[d]\\
\Spec R\ar[r]\ar@{-->}[ru]&\spec B
}\qquad
\xymatrix{
K\ar[r];[]_\alpha\xycofib[d];[]&A\ar[d];[]\\
R\ar[r];[]_\beta\ar@{-->}[ru];[]&B
}\]
As the left vertical is injective, we can assume that the right vertical in
injective. Now $R\alpha(A)$ is finite over $R$, in particular it's integral over
$R$, so that $R\alpha(A)=R$, (as a valuation ring is integrally closed). This
gives the dashed arrow.
\end{proof}
\end{exmp*}
\begin{exmp*}[Exercise 4.6]
A proper morphism of affine varieties over a field is finite.
\end{exmp*}
\begin{proof} Suppose that the morphism is induced by a ring map $B\to A$.
Denote the epi-mono factorisation as in the diagram. Whenever $A'\subset
R\subset A_{(0)}$ for a valuation ring $R$, we have the dashed arrows:
\[\xymatrix{
 \ar@{-->}[d];[]A_{(0)}& \ar@{..>}[ld]A\xycofibdown[l]
& \xycofibdown[l]A'\ar@{-->}[lld]\\
 R& \ar@{-->}[l]B\ar[u]\ar@{->>}[ur]\\
}\]
By properness we obtain the dotted arrow, and thus $A\subset R$. In particular,
$A$ is a subring of the integral closure $\overline{A'}$ of $A'$ in $A_{(0)}$,
and by finiteness of integral closure\index{integral closure!finiteness of},
$\overline{A'}$ is finite over $A'$. But $A'$ is Noetherian, so that $A$ is
finite over $A'$.
\end{proof}
\item \textbf{Theorem I.3.9A:}\indexThm{I.3.09A} (\index{integral
closure!finiteness of}finiteness of integral closure) Suppose that $A$ is an
integral domain which is a finitely generated $k$-algebra. Let $L$ be a finite
algebraic extension of the quotient field $A_{(0)}$. Then the integral closure
of $A$ in $L$ is a finite $A$-module and finitely generated $A$-algebra:
\[\xymatrix{
&&& \overline A_L\xycofib[r]&L\\
k\ar@{~>}[rrr]_{\text{finite type}}\ar[urrr]^{\text{finite type}}
&&&\xycofib[u]^{\text{finite}}\xycofib[r] A
&A_{(0)}\ar@{~>}[u]_{\text{finite algebraic}} \\
}\]
\item \textbf{Corollaries 4.6 \& 4.8:}\indexThm{II.4.06}\indexThm{II.4.08} When
everything is noetherian:
\begin{itemize}\squishlist
\item 
\begin{itemize}\squishlist 
\item Open and closed immersions are separated. 
\item Closed immersions are proper.
\end{itemize}
\item A composition of (separated/proper) morphisms is (separated/proper)
\item (Separated/proper) morphisms are stable under base extension.
\item Products of (separated/proper) morphisms are (separated/proper): if
$f_i:X_i\to Y_i$ are (separated/proper) morphisms in $\Schemes_S$, then
$f_1\times f_2:X_1\times_S X_2\to Y_1\times_S Y_2$ is (separated/proper).
\item
\begin{itemize}\squishlist 
\item If $X\to Y\to Z$ is separated, so is $X\to Y$.
\item If $X\to Y\to Z$ is proper, and $Y\to Z$ is separated, then $X\to Y$ is
proper.
\end{itemize}
\item Being (separated/proper) is local on the base.
All of these statements remain true if you replace `proper' with
`\Index{projective}'.
\end{itemize}
\item Define $\PP^n_A$ to be $\Proj A[x_0,\ldots,x_n]$ for any ring $A$. Given a
map $A\to B$ of rings, using the corresponding map $\Spec B\to \Spec A$ we have
$\PP^n_B\cong\PP^n_A\times_{\Spec A}\Spec B$. Thus we could define
$\PP^n_A:=\PP^n_\Z\times\Spec B$.
\item For any scheme $Y$, we define the \Index{projective $n$-space} $\PP^n_Y$
over $Y$, to be $\PP^n_\Z\times Y$.
\item A map $X\to Y$ is called \Index{projective} if it is essentially the
restriction to a closed subscheme of $\PP^n_Y$ of the map $\PP^n_Y\to Y$.
{\small(I.e.\ it factors as a closed immersion $X\to\PP^n_Y$ and then the
projection.)}
\item A map $X\to Y$ is called \Index{quasi-projective} if it is essentially the
restriction of $\PP^n_Y\to Y$ to an open subscheme of a closed subscheme of
$\PP^n_Y$. {\small(I.e.\ it factors as an open immersion into $X'$ followed by a
projective map $X'\to Y$.)}
\item \textbf{Theorem 4.9:}\indexThm{II.4.09} Projective morphisms of
noetherian schemes are proper. Quasi-projective morphisms of noetherian schemes
are of finite type and separated.
\item A \Index{variety} is an integral separated scheme of finite type over an
algebraically closed field $k$. If it is proper over $k$, we call it
\Index{complete}.
\item Let $X$ be reduced and let $Y$ be separated (over some base $S$). If
$f,g:X\to Y$ are $S$-morphisms which agree on an open dense subset of $X$, then
$f=g$.
\item In a separated scheme over an affine scheme, the intersection of affine
open subsets is affine. {\small (To see this, use the following pullback to see
that $U\cap V\to U\times V$ is a closed immersion, and note that $U\times V$ is
affine when $U$, $V$ and the base are affine.)
\[\xymatrix@R=.5cm{U\cap V\ar[r]\ar[d] &X\ar[d]\\U\times V\ar[r]&X\times X}\]}
\item A proper morphism of affine varieties over $k$ is a finite morphism.
\item A composite of projective morphisms in projective.
\item The image \index{image!of proper scheme}of a proper scheme is proper, in
the following sense. Suppose that $X\to Y$ is a morphism of separated schemes of
finite type over a noetherian scheme $S$. Suppose that $Z$ is a closed subscheme
of $X$ which is proper over $S$. Then the set-theoretic image of $Z$ is a closed
subset of $Y$, and the scheme-theoretic image, a closed subscheme of $Y$, is
proper.
\end{itemise}
\end{II.4 Separated and Proper Morphisms}
\begin{II.5 Sheaves of Modules}
\section*{Hartshorne II.5 --- Sheaves of Modules}
\index{Hartshorne!II.5: Sheaves of Modules}
\begin{itemise}
\item A \index{sheaf!of $\calO_X$-mods}sheaf of $\calO_X$-modules on a ringed
space $X$ is a sheaf $\scrF$ on $X$ such that $\scrF(U)$ is an
$\calO_X(U)$-module for each open $U$, compatibly with restrictions.
\item The category of $\calO_X$-modules is closed under taking kernels,
cokernels, images, quotients, direct limits, inverse limits, direct sums and
products. There is a \Index{sheaf Hom} for $\calO_X$-modules, requiring no
sheafification:
$\shfHom_{\calO_X}(\scrF,\scrG)(U):=\Hom_{\calO_X|_U}(\scrF|_U,\scrG|_U)$.
\item The \Index{tensor product} of $\calO_X$-modules is the sheafification of
$U\mapsto \scrF(U)\otimes_{\calO_X(U)}\scrG(U)$.
\\{\small\textbf{(I should think about whether the presheaf has (3).)}}
\item An $\calO_X$-module $\scrF$ is \Index{free} if it is a direct sum of
copies of $\calO_X$. It is \Index{locally free} if $\scrF|_U$ is a free
$\calO_X|_U$-module for some open $U$ around any point of $X$. The \Index{rank}
is well defined on each connected component. If it is locally free of rank one,
it is called \Index{invertible}.
\item A \Index{sheaf of ideals} on $X$ is a sheaf of modules $\scrI$ which is a
sub-$\calO_X$-module of $\calO_X$. That is, $\scrI(U)$ is an ideal of
$\calO_X(U)$ for all open $U$.
\item Constructing new sheaves of modules from old, given
$(f,f^\#):(X,\calO_X)\to (Y,\calO_Y)$:
\begin{itemize}\squishlist
\item 
\makebox[3cm][l]{\textbf{\Index{direct image}:} }
\makebox[1cm][r]{$f_*:$\ }$\calO_X\Modules\to\calO_Y\Modules$, using the
following module structure:
\[\calO_Y\times f_*\scrF\to f_*\calO_X\times f_*\scrF\to f_*\scrF.\]
\item
\makebox[3cm][l]{\textbf{\Index{inverse image}:} }
\makebox[1cm][r]{$f^{*}:$\ }$\calO_Y\Modules\to\calO_X\Modules$:\\
\phantom{sp} $\calO_X\in(f^{-1}\calO_Y)\Modules$ {\small (via
$(f^{-1}\calO_Y)\to\calO_X$}),
and $f^{-1}\scrG\in(f^{-1}\calO_Y)\Modules$. Define:
\[f^*\scrG:=F^{-1}\scrG\otimes_{f^{-1}\calO_Y}\calO_X.\]
\end{itemize}
\item There is an \Index{adjunction}
$f^*:\calO_Y\Modules\longleftrightarrow\calO_X\Modules:f_*$.
\item Given an $M\in A\Modules$, we obtain $\widetilde M\in\calO_X\Modules$,
where $X=\Spec A$. Assign $\frakp$ the stalk $M_\frakp$, and require that a
section be locally a quotient $m/a$, for $m\in M$ and $a\in A$ non-vanishing.
\item \textbf{Proposition 5.1:}\indexThm{II.5.01}
For any $f\in A$, $\widetilde M(D(f))\cong M_f$, and thus $\Gamma(X,\widetilde
M)=M$.
\item \textbf{Proposition 5.2:}\indexThm{II.5.02}
Let $X=\Spec A$. Then $M\mapsto \widetilde M$ gives an exact, fully faithful
functor $A\Modules\to\calO_X\Modules$, preserving tensor products and direct
sums. Moreover, for $f:\Spec B\to\Spec A$, $f_*$ and $f^*$ correspond to the
usual adjunction $f_*:A\Modules\longleftrightarrow B\Modules:f^*$.
\item A sheaf $\calF$ of $\calO_X$-modules is \Index{quasi-coherent} if $X$ can
be covered by open affine subsets $\spec A_i$ such that $\calF|_{\spec A_i}$ is
isomorphic to $\widetilde M_i$ for some $M_i\in A_i\Modules$. It is
\Index{coherent} if the $M_i$ can be taken to be finitely generated
$A_i$-modules.
\item \textbf{Proposition 5.4:}\indexThm{II.5.04} An $\calO_X$-module $\scrF$ is
quasi-coherent \Iff for every open affine $U=\spec A\subset X$,
$\scrF|_{U}\cong\widetilde M$ for some $M\in A\Modules$. The corresponding
test for coherence can be applied when $X$ is noetherian.
\item \textbf{Proposition 5.5:}\indexThm{II.5.05} If $X=\Spec A$,
$M\mapsto\widetilde M$ is an equivalence $A\Modules\to\QuasiCoherent_X$. As long
as $A$ is noetherian, it is also an equivalence
$A\Modules^\text{f.g.}\to\Coherent_X$.
\item \textbf{Proposition 5.6:}\indexThm{II.5.06}
If $0\to\scrF'\to\scrF\to\scrF''\to0$ is an exact sequence of $\calO_X$-modules,
where $X$ is affine, then
$0\to\Gamma(\scrF')\to\Gamma(\scrF)\to\Gamma(\scrF'')\to0$ is exact whenever
$\scrF$ is quasicoherent. {\small(Note that in fact, $H^1(X,\scrF')=0$, when $X$
is affine and $\scrF\in\QuasiCoherent_X$).}
\item \textbf{Proposition 5.7:}\indexThm{II.5.07}
$\QuasiCoherent_X$ is closed under taking kernels, cokernels, images and
extensions. So if $\Coherent_X$ when $X$ is noetherian.
\item \textbf{Proposition 5.8:}\indexThm{II.5.08}
Let $f:X\to Y$ be a morphism of schemes.
\begin{enumerate}\squishlist
\item[(a)] If $\scrG\in\QuasiCoherent_Y$, then $f^*\scrG\in\QuasiCoherent_X$.
\item[(b)] If $\scrG\in\Coherent_Y$, then $f^*\scrG\in\Coherent_X$, assuming $X$
and $Y$ are both noetherian.
\item[(c)] Assume that either $X$ is noetherian, or $f$ is quasi-compact and
separated. If $\scrF\in\QuasiCoherent_X$, then $f_*\scrF\in\QuasiCoherent_Y$.
{\small (Here, $f$ could be proper, or finite.)}
\end{enumerate}
\item \textbf{Exercise 5.5:}
If $f:X\to Y$ is a finite morphism of noetherian schemes, and
$\scrF\in\Coherent_X$, then $f_*\scrF\in\Coherent_Y$. {\small (Easy.)}
\item If $i:Y\to X$ is a closed subscheme, the kernel of the map $\calO_X\to
i_*\calO_Y$ is called the \Index{ideal sheaf} $\scrI_Y$ of $Y$. 
That is, $\scrI_Y$ is the ideal of functions on $X$ which vanish on $Y$.
\item By 5.7 and 5.8, $\scrI_Y$ is always quasi-coherent, and coherent when $X$
is noetherian.
\item \textbf{Proposition 5.9:}\indexThm{II.5.09}
Any quasi-coherent sheaf of ideals $\scrI$ on $X$ is the ideal sheaf of a
uniquely determined closed subscheme of $X$. {\small(In particular, closed
subschemes of $\Spec A$ correspond to ideals of $A$.)}
\begin{proof}
Let $Y=\supp(\calO_X/\scrI)$, giving a ringed space $(Y,\calO_X/\scrI)$. To
check that this is a closed subscheme, we may assume $X=\Spec A$. Then as
$\scrI$ is quasi-coherent, $\scrI=\widetilde\fraka$ for some ideal
$\fraka\subseteq A$. Then $\calO_X/\scrI=\widetilde
A/\widetilde\fraka=\widetilde {(A/\fraka)}$, which is simply $\calO_{\Spec
A/\fraka}$.
\end{proof}
\item Suppose that $S$ is a graded ring and $M$ is a graded $S$-module. Then we
can form a quasi-coherent sheaf $\widetilde M$ of $\calO_{\Proj S}$-modules by
the standard construction, defining the stalk at $\frakp$ to be $M_{(\frakp)}$,
the degree zero localisation of $M$, and requiring sections to be fractions
locally.
\item \textbf{Proposition 5.9:}\indexThm{II.5.09}
For homogeneous $f\in S_+$, we have $\widetilde
M|_{D_+(f)}=\widetilde{M_{(f)}}$, where we note that $D_+(f)\cong\Spec S_{(f)}$,
and $M_{(f)}$ is an $S_{(f)}$-module. Of course $\widetilde M$ is always
quasi-coherent, and is coherent if $S$ is noetherian and $M$ is finitely
generated.
\item Given a graded $S$-module $M$, we define the \Index{twisted module} $M(n)$
by $M(n)_d:=M_{n+d}$. If $X=\Proj S$, we define $\calO_X(n):=\widetilde{S(n)}$.
Serre's \Index{twisting sheaf} is $\calO_X(1)$. We twist other sheaves by
tensoring them with this one, defining $\scrF(n):=\scrF\otimes\calO(n)$.
\item\textbf{Proposition 5.12:}\indexThm{II.5.12} Suppose that $S$ and $T$ are
graded rings, such that $S$ ($T$) is generated by $S_1$ ($T_1$) as an
$S_0$-algebra ($T_0$-algebra). Let $X=\Proj S$ and $Y=\Proj T$. Then:
\begin{itemize}\squishlist
\item The sheaf $\calO_X(n)$ is invertible for all $n$.
\item For any graded $S$-module $M$, $\widetilde M(n)\cong\widetilde{M(n)}$.
Thus $\calO_X(n)\otimes\calO_X(m)=\calO_X(n+m)$.
\item Suppose $S\overset{\phi}{\to} T$ is a graded ring homomorphism, defining a
map $X\overset{f}{\longleftarrow} U\subseteq Y$. Then
$(f_*\calO_U)(n)\overset{f_*}{\mapsfrom}\calO_Y(n)|_U$ and
$\calO_X(n)\overset{f^*}{\mapsto}\calO_Y(n)|_U$.
\end{itemize}
\item Suppose $\scrF$ is a sheaf of $\calO_X$-modules, where $X=\Proj S$. The
\index{graded module!$\Gamma_*(\scrF)$}graded module associated to $\scrF$ is
$\bigoplus\Gamma(X,\scrF(n))$. This becomes a graded $S$-module, as any $s\in
S_d$ can be viewed as an element of $\Gamma(X,\calO_X(d))$, and there is a map:
\[\Gamma(X,\calO_X(d))\otimes\Gamma(X,\scrF(n))\to\Gamma(X,
\calO_X(d)\otimes\calO_F(n))=\Gamma(X,\scrF(n+d)).\]
This is great, since \textbf{proposition 5.15}\indexThm{II.5.15} states that if
$S$ is finitely generated by elements of $S_1$ as an $S_0$-algebra, and $\scrF$
is quasi-coherent, then $\widetilde{\Gamma_*(\scrF)}\cong\scrF$.
\item\textbf{Proposition 5.13:}\indexThm{II.5.13} If $S=A[x_0,\ldots,x_n]$, so
that $X=\Proj S=\PP^n_A$, then $\Gamma_*(\calO_X)\cong S$.
\item \textbf{Corollary 5.16:}\indexThm{II.5.16} Let $A$ be a ring.
\begin{itemize}\squishlist
\item Every closed subscheme\index{closed subscheme!of $\PP^n_A$} $Y$ of
$\PP^n_A$ arises from a homogeneous ideal of $S=A[x_0,\ldots,x_n]$.
{\small (We noted above that closed subschemes correspond precisely to
\emph{saturated} ideals: $\Gamma_*(\scrI_Y)$ is the saturated ideal.)}
\item A scheme over $\Spec A$ is projective \Iff it is $\Proj S$ for some graded
ring $S$ with $S_0=A$ and $S$ finitely generated by $S_1$ as an $A$-algebra.
{\small (Almost by definition.)}
\end{itemize}
To produce the ideal corresponding to $Y$, note that
$\scrI_Y\subset\calO_{\PP^n_A}$, twisting is exact, and global sections is left
exact, so that $\Gamma_*(\scrI_Y)\subset\Gamma_*(\calO_{\PP^n_A})=S$. 
\item For any scheme $Y$, $\PP^r_Y:=\PP^r_\Z\times Y$, and from the map
$\PP^r_Y\to\PP^r_\Z$, we pull back $\calO_{\PP^r_\Z}(1)$ to a sheaf
$\calO_{\PP^r_Y}(1)$ on $\PP^r_Y$, of course also called the \Index{twisting
sheaf}.
\item Here we'll define a relative notion, that of an invertible sheaf being
very ample. Suppose $X$ is a scheme over $Y$, and $\scrL$ is an invertible sheaf
on $X$. Then $\scrL$ is \Index{very ample} with respect to $Y$ if there is an
immersion $i:X\to\PP^r_Y$ (for some $r$) such that $\scrL\cong i^*(\calO(1))$.

\INDENT Here, an \Index{immersion} is the inclusion of an open subscheme of a
closed subscheme. \textbf{(These two phrases do not commute, right? So there's a
subtlety.)}
\item \textbf{Remark 5.16.1:}\indexThm{II.5.16.1} Suppose that $Y$ is
noetherian. Then a scheme $X$ is projective over $Y$ \Iff it is proper and
admits an invertible sheaf very ample with respect to $Y$.
\begin{proof}
The `only if' is easy. For `if', suppose $X$ is proper and $\scrL$ is very ample
on $X$ with respect to $Y$. Then by definition there is some embedding
$i:X\to\PP^r_Y$. However, the image of a proper scheme is proper, so that $i$ is
a closed immersion.
\end{proof}
\item A sheaf $\scrF$ of $\calO_X$-modules is said to be generated by global
sections\index{global sections!generated by} if there is a family of global
sections $s_i\in \Gamma(X,\scrF)$ such that the images of the $s_i$ generate the
$\calO_{X,p}$-module $\scrF_{X,p}$ for all $p\in X$. {\small (Note that $\scrF$
is generated by global sections \Iff it is the quotient of a free sheaf.)}
\item \textbf{Theorem 5.17:}\indexThm{II.5.17}
Let $X$ be a projective scheme over a noetherian ring $A$, let $\calO(1)$ be
very ample, and let $\scrF$ be a coherent $\calO_X$-module. Then $\scrF(n)$ is
generated by global sections for $n\gg0$. This yields the following:\\
\textbf{Corollary 5.18:}\indexThm{II.5.18}
$\scrF$ can be written as a quotient of a finite direct sum
$\bigoplus\calO(n_i)$.
\item \textbf{Theorem 5.19:}\indexThm{II.5.19}
Let $k$ be a field, $A$ be a finitely generated $k$-algebra, $X$ be a projective
scheme over $A$, and $\scrF$ a coherent $\calO_X$-module. Then $\Gamma(X,\scrF)$
is a finitely generated $A$-module.

\INDENT In particular, if $X$ is projective over $k$, then $\Gamma(X,\scrF)$ is
finite dimensional for all $\scrF\in\Coherent_X$.
\textbf{Corollary 5.20:}\indexThm{II.5.20}
Let $f:X\to Y$ be a projective morphism, where $X,Y$ are both of finite type
over a field $k$. Then $f_*\scrF\in\Coherent_Y$ for any $\scrF\in\Coherent_X$.
\begin{proof}
We may assume $Y=\Spec A$. We already saw that $f_*\scrF$ is quasi-coherent, so
we only need to check that $\Gamma(Y,\scrF)$ is finitely generated $A$-module.
\end{proof}
\item Suppose that $\scrE$ is a locally free $\calO_X$-module of finite rank. We
define the dual $\check\scrE$ of $\scrE$ to be
$\shfHom_{\calO_X}(\scrE,\calO_X)$. Then as usual, (for any
$\scrF,\scrG\in\calO_X\Modules$):
\[\check{\check\scrE}\cong\scrE,\ \ \ 
\shfHom_{\calO_X}(\scrE,\scrF)\cong\check\scrE\otimes\scrF,\ \ \ 
\Hom_{\calO_X}(\scrE\otimes\scrF,\scrG)\cong\Hom_{\calO_X}
(\scrF,\shfHom_{\calO_X}(\scrE,\scrG)).\]
\item We have the following \textbf{\Index{projection formula}}, given $f:X\to
Y$, $\scrF\in\calO_X\Modules$ and $\scrE\in\calO_Y\Modules$, with $\scrE$
locally free:
\[f_*(\scrF\otimes_{\calO_X}f^*(\scrE))\cong f_*(\scrF)\otimes_{\calO_Y}\scrE.\]
{\small (That is, given $f:X\to Y$, a sheaf $\scrF$ on the $X$ and a locally
free sheaf $\scrE$ on $Y$, we can form two tensor products. We can pull $\scrE$
back to $X$ and tensor with $\scrF$, or push $\scrF$ forward to $Y$ and tensor
with $\scrE$. The two outcomes are the same when they are compared on $Y$.)}
\item Let $X$ be a noetherian scheme, and let $\scrF$ be a coherent sheaf. Then
$\scrF$ is locally free \Iff the stalks $\scrF_x$ are free $\calO_{X,x}$-modules
for all $x\in X$. Moreover, $\scrF$ is \Index{invertible} (locally free of rank
one) \Iff there exists $\scrG\in\Coherent_X$ such that
$\scrF\otimes\scrG\cong\calO_X$ {\small (justifying the name `invertible')}. Of
course, $\scrG=\check\scrF$.
\begin{proof}
Suppose that $\scrF$, $\scrG$ are coherent (over a noetherian scheme $X$) such
that $\scrF\otimes \scrG\cong\calO_X$. It is enough to prove that $\scrF_x$ is a
free $\calO_{X,x}$-module of rank one for all $x$, as this shows that $\scrF_x$
is locally free of rank one. Now write $M=\scrF_x$, $N=\scrG_x$ and
$L=\calO_{X,x}$. We know that $L$ is local, and $M\otimes_L N=L$. All we are to
do is show that in this setting, $M$ is a free module of rank 1. But we have
$(M\otimes_L N)/\frakm(M\otimes_L N)=M/\frakm M\otimes_{L/\frakm}N/\frakm N$,
and this tensor product has dimension one! So $M/\frakm M$ has dimension one
over the residue field, and Nakayama's lemma shows that $M$ is generated by one
element. Of course, this element must have annihilator zero, so that $M$ is free
of rank one.
\end{proof}

\item \textbf{Exercise 5.8:}
Let $X$ be noetherian, and $\scrF\in\Coherent_X$. Consider
$\phi(x):=\dim_{k(x)}\scrF_x\otimes_{\calO_x}k(x)$, where
$k(x)=\calO_x/\frakm_x$ is the residue field at $x$. Prove:
\begin{enumerate}\squishlist
\item[(a)] $\phi$ is \Index{upper semicontinuous} (i.e.\ it exceeds any given
value on a closed set).
\item[(b)] If $\scrF$ is locally free, then $\phi$ is locally constant.
\item[(c)] Conversely, if $X$ is reduced, and $\phi$ is locally constant, then
$\scrF$ is locally free.
\end{enumerate}
\emph{Interpretation of $\phi(x)$} --- suppose that $\scrF$ is the sheaf of
sections of an $n$-bundle (which is locally free). Then $\scrF_x$ is the
$\calO_x$-module of germs of sections at $x$, where $\calO_x$ is the local ring
of germs of functions at $x$. Tensoring with $k(x)$ removes the word `germs': we
have $\scrF_x\otimes k(x)=\scrF_x/\frakm_x\scrF_x$, which is the $k(x)$-vector
space of values of the sections can take over $x$. Thus, we obtain the rank of
$\scrF$ at $x$. Had we not assumed that $\scrF$ was locally free, then we would
still have obtained a nice number measuring the size of the stalk.

\INDENT We'll prove this result using \textbf{\Index{Nakayama's lemma}}: suppose
that $(A,\frakm)$ is a local ring and $M$ is a finitely generated $A$-module.
Then any basis for the $A/\frakm$-vector space $M/\frakm M$ lifts to a (minimal)
generating set for $M$ as an $A$-module.

\INDENT In the context of the exercise, we use the local ring
$(\calO_x,\frakm_x)$, and the finitely generated module $\scrF_x$. Thus we may
reinterpret $\phi(x)$ as the minimal number of generators required for the
module $\scrF_x$.

\begin{proof} To prove (a), we'll observe that generators of $\scrF_x$ extend to
sections $s_i\in\Gamma(U,\scrF)$, where $U$ is an open neighbourhood of $x$, and
that the image of the $s_i$ generates the stalks $\scrF_y$ for $y$ in some
smaller neighbourhood of $x$. For this, we may assume that in fact $U=\Spec R$
for $R$ noetherian in which case $\scrF|_U=\widetilde M$ for some $M\in
R\Modules^\text{f.g.}$, generated by $g_1,\ldots,g_n$. Then the $s_i$ are in
fact elements of $M$, which generate $M_x$ as an $R_x$-module. That is to say,
there are elements $a_{ij}\in R$ and $t\in R\setminus x$ such that:
\[m_i=\sum_{j}\frac{a_{ij}}{t}\cdot s_j, \text{ for each $j$}.\]
Of course, this expression makes sense wherever $t\in R$ remains invertible ---
on $D(t)\subset R$.

(b) follows from basic considerations of rank. For (c), we reduce to the case
where $X=\spec A$, $\scrF=\widetilde M$, and we have $m_1,\ldots,m_r\in M$ which
minimally generate $M_p$ in each localisation. Then we have a map $\gamma:A^r\to
M$, given by $(x_1,\ldots,x_r)\mapsto \sum x_im_i$, such that $(A_\frakp/\frakp
A_\frakp)^r\to M_\frakp/\frakp M_\frakp$ is an isomorphism for all $\frakp$. Of
course, if $(x_1,\ldots,x_r)\in\ker\gamma$, then $x_i\in\frakp$ for all
$\frakp$, so that $x_i=0$ (as $R$ is reduced). So $\gamma$ is an isomorphism.
\end{proof}
\item A note on vector bundles: a finitely generated module over a noetherian
ring is locally free if and only if it is projective, so over an affine
noetherian scheme $\Spec A$, the vector bundles and the finitely generated
projective $A$-modules coincide.
\end{itemise}
\end{II.5 Sheaves of Modules}
\begin{II.6 Divisors}
\section*{Hartshorne II.6 --- Divisors}
\index{Hartshorne!II.6: Divisors}
\begin{itemise}
\item A scheme is said to be \index{regular!in codimension 1}regular in
codimension one if every local ring of dimension one is regular. {\small (This
includes nonsingular varieties, and noetherian normal schemes, as a noetherian
local domain of dimension one is integrally closed \Iff it is regular.)}
\item In our discussion of Weil divisors, we consider schemes satisfying the
following conditions:
\begin{itemise}
\item[($*$)] $X$ is a noetherian integral separated scheme, regular in
codimension one.\footnote{Everything always needs to be separated and
noetherian. $X$ needs to be integral so that there is a function field. $X$
needs to be regular in codimension one so that we can define the degree of
vanishing of an element of the function field using the DVR
structure.}\index{divisor!condition ($*$)}
\end{itemise}
\item Let $X$ be a scheme satisfying ($*$). 
\begin{itemize}\squishlist
\item A \index{divisor!prime}prime divisor is a closed integral subscheme of
codimension one. {\small (A closed integral subscheme is determined by its
set-theoretic image.)}
\item A \index{divisor!Weil} Weil divisor is an element of the free abelian
group $\WeilDivisors$ on the prime divisors.
\item A Weil divisor is effective \index{divisor!effective} if it is a
nonnegative linear combination of prime divisors.
\end{itemize}
\item Suppose that $X$ satisfies ($*$), and that $f\in K^*$, where $K$ is the
function field. Each prime divisor $Y$ with generic point $\eta$ gives a DVR
$\calO_{X,\eta}$ with quotient field $K$. We denote by $v_Y$ the valuation on
$K$ corresponding to this DVR. {\small (When $v_Y(f)$ is positive, it measures
the highest power of the maximal ideal $f$ lies in.)} Depending on whether
$v_Y(f)$ is positive or negative, we say that $f$ has a zero or a pole on $Y$.
\item We define a divisor $(f)=\sum v_Y(f)\cdot Y$. This is called a
\index{divisor!principal} principal divisor, 
{\small (lemma 6.1\indexThm{II.6.01} states that it is actually a finite sum as
required)} and the map $K^*\to\WeilDivisors(X)$ is a homomorphism.
\item The \index{divisor!class group}divisor class group $\DivisorClass(X)$ is
the cokernel of this homomorphism. That is, $\DivisorClass(X)$ is the group
$\WeilDivisors(X)$ modulo linear equivalence,\index{divisor!linear equivalence}
where two divisors are linearly equivalent if they differ by a principal
divisor.
\item \textbf{Proposition 6.2:}\indexThm{II.6.02}
Let $A$ be a noetherian domain. Then $A$ is a \Index{UFD} \Iff $X=\Spec A$ is
\Index{normal} and $\DivisorClass (X)=0$. {\small(The proof uses
\textbf{proposition 6.3A},\indexThm{II.6.03A} which essentially states that if
$A$ is a noetherian normal domain, $a\in A_{(0)}$ defines a function on all of
$\Spec A$ \Iff it has no poles on any prime divisor.)}
\item This shows that $\DivisorClass(\A^n_k)=0$.
\item When $A$ is a Dedekind domain, $\DivisorClass(\Spec A)$ is the
\Index{ideal class group} of $A$.
\item \textbf{Proposition 6.4:}\indexThm{II.6.04} Let $X=\PP^n_k$ ($k$ a field).
The homomorphism $\deg:\WeilDivisors(X)\to\Z$ which sends a prime divisor to its
\Index{degree} {\small(the degree of a polynomial used to generate its
homogeneous ideal)} has kernel the subgroup of principal divisors. Thus
$\DivisorClass(X)=\Z$, generated by the class of a hyperplane.
\begin{proof}
Note that if $D$ is a divisor of degree $d$, then $D\sim dH$, where $H$ is the
hyperplane $x_0=0$. Moreover, it is clear (as $K=k[x_0,\ldots,x_n]_{(0)}$), that
any $f\in K^*$ has $\deg(f)=0$.
\end{proof}
\item \textbf{Proposition 6.5:}\indexThm{II.6.05}
Suppose that $X$ satisfies ($*$), and that $Z$ is a proper closed subset. Let
$U=X-Z$. Then the map $\WeilDivisors(X)\to\WeilDivisors(U)$ sending a prime
divisor $Y$ to $Y\cap U$ (or zero if this is empty) descends to a surjective
homomorphism $\DivisorClass(X)\to\DivisorClass(Y)$.
\begin{itemize}\squishlist
\item If $Z$ has codimension more that one, this is an isomorphism.
\item If $Z$ is irreducible of codimension one, the kernel is generated by $Z$.
That is, there is an exact sequence
$\Z\to\DivisorClass(X)\to\DivisorClass(U)\to0$, where $1\mapsto 1\cdot
Z\in\DivisorClass(X)$.
\end{itemize}
\item If $Y$ is an irreducible curve of degree $d$ in $\PP^2$, then
$\DivisorClass(\PP^2-Y)=\Z_d$.
\item \textbf{Example 6.5.2:}\indexThm{II.6.05.2} the \Index{quadric cone},
$xy=z^2$. Let $A=k[x,y,z]/xy-z^2$, and let $X=\Spec A$, the quadric cone. Let
$Y$ be the divisor specified by $y=z=0$.
\begin{itemize}\squishlist
\item We determine that $X-Y$ is $\Spec A_y$, as $y=0$ determines that $z=0$.
Now $A_y=k[y^{\pm1},z]$ is a UFD so that $\DivisorClass(X-Y)=0$. Thus the above
exact sequence tells us that $\DivisorClass(X)$ is generated by the image of the
prime divisor $Y$.
\item We calculate the principal divisor $(y)$. To find $v_Y(y)$, we note that
the generic point of $Y$ is the ideal $\fraky=(y,z)\subset A$. In the
localisation $A_\fraky$, this becomes the maximal ideal, any polynomial which is
nonzero upon substituting $y=z=0$ becomes invertible. That includes $x$, so we
can write $y=x^{-1}z^2$. In particular, $z$ generates the maximal ideal, and $y$
has valuation two. The function $y$ has no poles, and has no other zeros, so
that $(y)=2Y$.
\item For a noetherian domain, being normal\index{normal!is local property} is a
local property ($A$ is normal \Iff the $A_\frakp$ are normal \Iff the $A_\frakm$
are normal), and $A$ is integrally closed (exercise 6.4 --- essentially as
$xy-z^2$ is squarefree). Thus it is enough to show that $A$ is not a UFD, in
order to see that $Y$ is not principal, and that $\DivisorClass(X)=\Z_2\langle
Y\rangle$. It was obvious from the beginning that $A$ was not a UFD: $xy=z^2$!
\end{itemize}
\item \textbf{Proposition 6.6:}\indexThm{II.6.06}
If $X$ satisfies ($*$), then so does $X\times \A^1$, and
$\DivisorClass(X\times\A^1)=\DivisorClass(X)$.
\begin{proof}
The key point is to observe that we can reduce to divisors which are the product
of a codimension one point of $X$ with $\A^1$. To see this, let $K$ be the
function field of $X$. Then we have pullbacks:
\[\xymatrix@R=.4cm{
\spec K[t]\ar[r]\ar[d]&X\times\A^1\ar[r]\ar[d]&\spec K[t]\ar[d]\\
\spec K\xycofib[r]&X\ar[r]&\spec \Z
}\]
Now given a prime divisor $Z\subset X\times\A^1$, we intersect with $\spec
K[t]$, the fibre of $\eta_X$, to obtain a divisor $Z'$ on $\spec K[t]=\A^1_K$.
As $K[t]$ is a UFD, we have that $\DivisorClass(\A^1_K)=0$, so that $Z'$ is
principal, equal to $(f)$ for some $f\in K(t)$. In particular, back on
$X\times\A^1$, $Z-(f)$ has zero intersection with the fibre of $\eta_X$, so that
its components are supported $C\times\A^1$, for $C\subset X$ a proper closed
subset. But then, for dimension reasons, we must have $Z-(f)$ equal to a sum of
divisors of the form $y\times\A^1$, where $y\in X$ has codimension one.

\INDENT Now we have a map
$\pi_1^*:\DivisorClass(X)\to\DivisorClass(X\times\A^1)$ given by taking the
preimage under the first projection. This map is surjective, by the previous
argument. To see that it is injective, suppose that $\sum n_y(y\times\A^1)$ is
zero in $\DivisorClass(X\times\A^1)$. Then $\sum n_y(y\times\A^1)=(f)$ for $f$ a
nonzero element of the function field of $X\times \A$. This function field is in
fact the quotient field of $K[t]$, so that $f=g/h$ for $g,h\in
K[t]\setminus\{0\}$. We can assume that $(g,h)=1$, so that there is no
cancellation when taking the difference $(g)-(h)$. We want to see that $f,g$ are
in fact constant polynomials, so that the sum $\sum n_y(y)$ was already zero in
$\DivisorClass(X)$.

\INDENT As $(g,h)=1$, we have that $(g)$ contains only prime divisors of the
form $y\times\A^1$. But this should imply that $g$ is a constant polynomial. If
$g$ is not constant, let $\spec R\in X$ be any open affine subset. Then form the
intersection:
\[\xymatrix@R=.4cm{
\spec K[t]/g\ar[r]\ar[d]&\spec R[t]/g\ar[d]\\%&X\times\A^1\ar[d]\\
\spec K\xycofib[r]&\spec R%\xycofib[r]&X
}\]
That this intersection (of $(g)$ with $\eta_X\times\A^1$) is nonempty gives a
contradiction.
\end{proof}
\item \textbf{Exercise 6.1:} Let $X$ satisfy ($*$). Then $X\times\PP^n$
satisfies ($*$), and $\DivisorClass(X\times\PP^n)=\DivisorClass(X)\times\Z$.
\begin{proof}
For proposition 6.5, we have an exact sequence, and it splits:
\[\xymatrix@R=.2cm{
\Z\ar[r]&
\DivisorClass(X\times\PP^n)\ar[r]&
\DivisorClass(X\times\A^n)\ar[r]\ar@{=}[d]&
0\\
&&\DivisorClass(X)\ar[ul]^{\pi^*}
}\]
All that remains is to check that the image of $1\in\Z$, being the class of
$X\times H$ ($H$ a hyperplane), has infinite order. But this will follow by an
argument as above, noting that the class of a hyperplane in
$\DivisorClass(\PP^n)$ has infinite order, by proposition 6.4.
\end{proof}

\item To save a bit of time, I'm skipping the next few examples. Note, however,
that the nonsingular \Index{quadric surface} $xy=zw$ in $\PP^3$, which is just
the Segre embedding of $\PP^1\times\PP^1$, has class group $\Z\times\Z$, with
the obvious generators.
\item Let $k$ be algebraically closed. A \Index{curve} over $k$ is an integral
separated scheme $X$ of finite type over $k$, of dimension one. If $X$ is proper
over $k$, we say it is \Index{complete}.
\item \textbf{Proposition 6.7:}\indexThm{II.6.07}
Let $X$ be a nonsingular curve over $k$ with function field $K$. Then $X$ is
projective \Iff $X$ is complete \Iff $X=t(C_K)$.\index{complete nonsingular
curve}
\item \textbf{Proposition 6.8:}\indexThm{II.6.08}
Let $X$ be a \Index{complete nonsingular curve} over $k$, $Y$ be any curve over
$K$, and let $f:X\to Y$ be a \emph{nonconstant} morphism. Then $f(X)=Y$, $K(X)$
is a finite extension of $K(Y)$, $f$ is a finite morphism, and $Y$ is complete.
\item To study divisors on a nonsingular curve $X$, we define a map
$\deg:\WeilDivisors (X)\to \Z$\index{degree!divisor on curve} which sends each
prime divisor (i.e.\ each closed point) to $1$.
\item If $f:X\to Y$ is a finite morphism of curves\index{finite!map of curves},
we define the \index{degree!map of curves} degree of $f$ to be the degree of
the extension $[K(X):K(Y)]$.
\item Given a finite map $f:X\to Y$, we obtain a
$f^*:\WeilDivisors(Y)\to\WeilDivisors(X)$ by the following method. To define
$f^*(Q)$, let $t\in\calO_Q$ be a \Index{local parameter} at $Q$: an element of
$K(Y)$ with $v_Q(t)=1$. Calculate $v_P(f^*t)$ for each of the (finitely many)
points $P\in f^{-1}(Q)$, and use these as the coefficients of said $P$ in
$f^*(Q)$.\footnote{Note that if $f$ is \Index{unramified} at $P$, the
coefficient $v_P(f^*(t))$ of $P$ in $f^*(Q)$ is one.} This induces a
homomorphism $f^*:\DivisorClass(Y)\to\DivisorClass(X)$. Moreover,
\textbf{Proposition 6.9}\indexThm{II.6.09} states that $\deg(f^*(Q))=\deg(f)$
for all $Q\in Y$, so that:
\item\textbf{Corollary 6.10:}\indexThm{II.6.10} A principal divisor on a
\Index{complete nonsingular curve} $X$ has degree zero, so that the degree
function gives an epimorphism $\DivisorClass(X)\to\Z$.
\item\textbf{Example 6.10.1:}\indexThm{II.6.10.1}
By proposition 6.8 and 6.9: a \Index{complete nonsingular curve} is
\Index{rational} (birational to $\PP^1$) \Iff there exist two distinct linearly
equivalent points.
\begin{proof}
If $X$ is rational, it's already projective, by 6.7, so we're done. Suppose
instead that $P\sim Q$. Then for some $f\in K(X)$, viewed as a morphism
$X\to\PP^1$, we have $f^{-1}(0)=P$, $f^{-1}(\infty)=Q$. By proposition 6.9,
$\deg(f)=1$, so that $[K(X):K(\PP^1)]$ has degree one, and $X$ is rational.
\end{proof}
\item\textbf{Example 6.10.2:}\indexThm{II.6.10.2}
Let $X$ be the nonsingular cubic $y^2z=x^3-xz^2$ in $\PP^2$
($\text{char}(k)\neq2$). $X$ is not rational. Let $\DivisorClass^\circ X$ be the
kernel of $\deg:\DivisorClass(X)\to\Z$, a nonzero group. We'll see that the
group $\DivisorClass^\circ(X)$ can be put in bijection with the points of $X$,
making $X$ an abelian group variety.

\INDENT Whenever $P$, $Q$ and $R$ are three points of $X$, we will write
$\overrightarrow{PQR}$ as shorthand for ``$P$, $Q$ and $R$ are
collinear''.\footnote{I.e.\ $\overrightarrow{PQR}$ \Iff $P$, $Q$ and $R$ are the
three points of intersection of a line in $\PP^2$ with $X$, counted with
multiplicity.} The observation which generates all others is that if
$\overrightarrow{PQR}$ and $\overrightarrow{ABC}$, then $P+Q+R$ and $A+B+C$ are
linearly equivalent divisors.

\INDENT Now let $P_0$ be any fixed point of $X$.\footnote{One might choose
$P_0=[0:1:0]$, the point of inflection, so that $\overrightarrow{P_0P_0P_0}$.}
Given any two points $R$ and $S$, find $I$ such that $\overrightarrow{RP_0I}$
and then $D$ such that $\overrightarrow{ISD}$. Then $R-S=D-P_0$. Given any two
points $P$ and $Q$, find $I$ such that $\overrightarrow{PQI}$ and then $S$ such
that $\overrightarrow{IP_0S}$. Then $P+Q=S+P_0$. We can rewrite these equations
as:
\[(R-P_0)-(S-P_0)=(D-P_0);\qquad (P-P_0)+(Q-P_0)=(S-P_0).\]
In particular, every element of the group $\DivisorClass^\circ(X)$ can be
written as $(P-P_0)$ for some $P\in X$. This element is unique, as otherwise,
$P\sim Q$ for some $P\neq Q$, which (by 6.10.1) would contradict the fact that
$X$ is not rational. Thus $X$ is in bijection with $\DivisorClass^\circ(X)$ via
$P\longleftrightarrow (P-P_0)$, and the two constructions of $S$ and $D$ used
above describe the sum and difference in the induced group structure on $X$.
\item If $X$ is a \Index{complete nonsingular curve}, then
$\DivisorClass^\circ(X)$ is isomorphic to the set of closed points of the
\Index{Jacobian variety} $J(X)$ of $X$. The dimension of $J(X)$ equals the
\Index{genus} of $X$! The whole of $\DivisorClass(X)$ is an extension of $\Z$ by
the group of closed points of $J(X)$.
\end{itemise}
\subsection*{Cartier Divisors}\index{divisor!Cartier}
\begin{itemise}
\item First, we will need an analogue for general schemes $X$ of the function
field of an integral scheme. This will be the sheaf $\scrK$ of \Index{total
quotient ring}s. It has an associated sheaf of (multiplicative) abelian groups,
$\scrK^*$, the invertible elements in each ring, and there is an evident short
exact sequence, $1\to\calO^*\to\scrK^*\to\scrK^*/\calO^*\to1$, yielding:
%\[1\to\Gamma(X,\calO^*)\to\Gamma(X,\scrK^*)\overset{\pi_*}{\to}
%\Gamma(X,\scrK^*/\calO^*)\to H^1(X,\calO^*)\to H^1(X,\scrK^*)\to\cdots.\]
\[\qquad\qquad\qquad\xymatrix@!0@C=1.7cm@R=1.2cm{
{\Gamma(X,\scrK^*)}\ar[rr]^{\pi_*\ \ }\ar@{->>}[rd]&&
\overset{\text{(Cartier divisors)}}
{\Gamma(X,\scrK^*/\calO^*)}\ar[rr]\ar@{->>}[rd]&&
\overset{\text{(Picard group)}}
{H{\raisebox{0cm}[0cm][0cm]{$^1$}}(X,\calO^*)}\ar[rr]&& H^1(X,\scrK^*)\\
&\makebox[0cm][r]{$\Gamma(X,\scrK^*)/\Gamma(X,\calO^*)=$}
\underset{\text{(Principal divisors)}}
{\PrincipalCartierDivisors(X)}\ar@{^{(}->}[ru]
&&\underset{\text{(Cartier class group)}}
{\CartierClass(X)}\ar@{^{(}->}[ru]_\scrL
}\]
A Cartier divisor\index{divisor!Cartier} is an element of
$\Gamma(X,\scrK^*/\calO^*)$, and the principal Cartier
divisors\index{divisor!principal Cartier} are those in the image of $\pi_*$. We
define the Cartier class group $\CartierClass(X)$\index{divisor!$\CartierClass$}
to be the cokernel of $\pi_*$. As $H^1(X,\calO^*)$ is the \Index{Picard group}
$\Picard(X)$ of invertible sheaves on $X$, we obtain a natural injective map
$\scrL:\CartierClass(X)\to\Picard(X)$.
\item There are two ways to think about the sheaf $\scrK$ of total quotient
rings.
\begin{itemize}\squishlist
\item For each open affine $U=\Spec A$, let $K(U)$ be the \Index{total quotient
ring} of $A$: the localisation of $A$ by the multiplicative system of
non-zero-divisors in $A$. These rings form a presheaf \emph{on the basis of open
affine subsets}, and the sheafification is the sheaf of total quotient rings
$\scrK$.
\item For each open subset $U$, let $S(U)$ be the set of elements of
$\Gamma(U,\calO)$ which are map to non-zero-divisors in each local ring
$\calO_x$ for $x\in U$. The rings $\Gamma(U,\calO)[S(U)^{-1}]$ form a presheaf,
whose associated sheaf of rings is also $\scrK$.
\end{itemize}
\item A Cartier divisor can be specified by giving an open cover $\{U_i\}$ of
$X$ and elements $f_i\in\Gamma(U_i,\scrK^*)$ such that each $f_i/f_j$ is an
element of $\Gamma(U_i\cap U_j,\calO^*)$.
\item \textbf{Proposition 6.11:}\indexThm{II.6.11}
Let $X$ be an integral, separated noetherian scheme, all of whose local rings
are UFDs\footnote{A ring all of whose localisations are UFDs is called
\Index{locally factorial}. For a one-dimensional local ring, being a UFD is the
same as being regular.} (thus $X$ satisfies ($*$)). Then
$\WeilDivisors(X)\cong\CartierDivisors(X)$, and principal Weil divisors
correspond to principal Cartier divisors, so that
$\DivisorClass(X)\cong\CartierClass(X)$.

\INDENT As $X$ is integral, $\scrK^*$ is just the constant sheaf $K^*$. Given a
Cartier divisor $\{(U_i,f_i)\}$, for a given prime Weil divisor $Y$, choose $i$
such that $U_i\cap Y\neq\emptyset$. Then in fact $U_i\cap Y$ is dense in $Y$,
and $\eta_Y$ is contained in $U_i$. Thus we can calculate $v_Y(f_i)$, and make
this the coefficient of $Y$. This sum is finite, as $X$ is noetherian. This
construction can be carried through even when $X$ is only normal. In fact:
\item \textbf{Remark 6.11.2:}\indexThm{II.6.11.2} If $X$ is only a normal scheme
(not locally factorial), then we can define a subgroup
$\LocallyPrincipalWeilDivisors(X)$ of $\WeilDivisors(X)$ consisting of the
locally principal Weil divisors,\index{divisor!locally principal} those
$D\in\WeilDivisors(X)$ which can be covered by open sets such that $D|_U$ is
principal for all $U$. Then the above construction gives an isomorphism
$\CartierDivisors(X)\cong\LocallyPrincipalWeilDivisors(X)$. Moreover, as
principal Weil divisors are locally principal, this descends to class groups,
and $\CartierClass(X)$ is isomorphic to the subgroup of $\DivisorClass(X)$
consisting of locally principal divisors.
\item \textbf{Example 6.11.3:}\indexThm{II.6.11.3}
To give a Weil divisor which is not Cartier, we revisit example 6.5.2, the
quadric cone $xy=z^2$. We just need to see that $Y$ is not locally principal.
That is, we should see that $(y,z)$ is not principal in the ring
$k[x,y,z]/(xy-z^2)[S^{-1}]$, where $S$ is the multiplicative set of elements
which are nonzero at $(0,0,0)$. This is true! Thus $\CartierClass=0$ while
$\DivisorClass=\Z_2$.
\end{itemise}
\subsection*{Invertible sheaves}
\begin{itemise}
\item Given a Cartier divisor $\calD=(U_i,f_i)$, we obtain an invertible sheaf
$\scrL(D)$ as the sub-$\calO_X$-module of $\scrK$ generated by $f_i^{-1}$ over
$U_i$.
\item To describe the map $\scrL$, note that we have defined:
\[\scrL(D)(U):=\{f\in\scrK\,:\,(f)+D\geq0\textup{ on $U$}\}.\]
\item \textbf{Proposition 6.13:}\indexThm{II.6.13}
$D\mapsto\scrL(D)$ gives a bijection between Cartier divisors and invertible
subsheaves of $\scrK$. Moreover $D_1\sim D_2$ \Iff $\scrL(D_1)\cong\scrL(D_2)$.
\item \textbf{Corollary 6.14:}\indexThm{II.6.14}
$D\mapsto\scrL(D)$ gives an injective map
$\CartierClass(X)\cofibration\Picard(X)$.
\item \textbf{Proposition 6.15:}\indexThm{II.6.15}
$\CartierClass(X)\weakequiv\Picard(X)$ is an isomorphism when $X$ is integral.
\item \textbf{Corollary 6.16:}\indexThm{II.6.16}
If $X$ is a noetherian, integral, separated locally factorial scheme, then there
is a natural isomorphism $\CartierClass (X)\cong\Picard(X)$.
\item \textbf{Corollary 6.17:}\indexThm{II.6.17}
$\Picard(\PP^n_k)\cong\Z$.
\item An effective\index{divisor!effective Cartier} Cartier divisor is one of
the form $(U_i,f_i)$ with $f_i\in\Gamma(U_i,\calO_{U_i})$. Then we can define
the associated subscheme\index{divisor!effective Cartier!assoc subscheme} of
codimension one, as the subscheme defined by the sheaf of ideals locally
generated by $f_i$.
\item This gives a bijective correspondence between effective Cartier divisors
and locally principal closed subschemes. Moreover:
\item \textbf{Proposition 6.18:}\indexThm{II.6.18}
If $D$ is an effective Cartier divisor, and $Y$ is the associated locally
principal closed subscheme, then $\scrI_Y\cong\scrL(-D)$.
\end{itemise}
\end{II.6 Divisors}
\begin{II.7 Projective Morphisms}
\section*{Hartshorne II.7 --- Projective Morphisms}
\index{Hartshorne!II.7: Projective Morphisms}
\begin{itemise}
\item \textbf{Theorem 7.1:}\indexThm{II.7.01} Suppose $A$ is a ring and $X$ is a
scheme over $A$. Then it is the same to give an $A$-morphism $\phi:X\to \PP^n_A$
as to give an invertible sheaf $\scrL$ on $X$ generated by global sections
$s_0,\ldots,s_n$.
\begin{proof}
Given $\phi$, let $\scrL=\phi^*\calO(1)$, and let $s_i=\phi^*(x_i)$, where
$x_i\in\calO(1)$. On the other hand, let $X_i=\{P\in
X\,|\,(s_i)_P\notin\frakm_P\scrL_P\}$. This is an open subset of $X$ (which is
\textbf{not} the support of $s_i$). Define a morphism $X_i\to U_i$ via a map
\smash{$A\left[\frac{x_0}{x_i},\ldots,\frac{x_n}{x_i}\right]\to
\Gamma(X_i,\calO_{X_i})$}
sending $\frac{x_r}{x_i}$ to the ratio of $s_r$ to $s_i$ in each stalk.
\end{proof}
\item \textbf{Example 7.1.1: Automorphisms of $\PP^n_k$.}\index{automorphisms of
$\PP^n_k$}\indexThm{II.7.01.1} Every automorphism of $\PP^n_k$ is PGL. Suppose
that $\phi$ is an automorphism. Then $\phi^*(\calO(1))$ generates
$\Picard(\PP^n)$, so is $\calO(\pm1)$. But it must have a nonzero section, so
that $\phi^*(\calO(1))\cong\calO(1)$. But now $\phi$ is determined by the global
sections $\phi^*(x_i)$, which must a basis of the $(n+1)$-dimensional vector
space $\Gamma(\PP^n_k,\calO(1))$.
\item \textbf{Proposition 7.2:}\indexThm{II.7.02} If $\phi$ is the morphism as
in 7.1, then $\phi$ is a closed immersion \Iff
\begin{enumerate}\squishlist
\item[(1)] each open set $X_i$ is affine, and
\item[(2)] the maps \smash{$A\left[\frac{x_0}{x_i},\ldots,\frac{x_n}{x_i}\right]
\to\Gamma(X_i,\calO_{X_i})$} are surjective.
\end{enumerate}
\item \textbf{Proposition 7.3:}\indexThm{II.7.03} If $A=k=\overline{k}$ is an
algebraically closed field, and $X$ is projective over $k$. Let
$V\subset\Gamma(X,\scrL)$ be the subspace spanned by the $s_i$. Then $\phi$ is a
closed immersion \Iff
\begin{enumerate}\squishlist
\item[(1)] elements of $V$ separate points\index{separate!points}: for all
distinct closed points $P,Q$, there's an $s\in V$ such that
$s\in\frakm_P\scrL_P$ but $s\in\frakm_Q\scrL_Q$ or vice versa, and
\item[(2)] elements of $V$ separate tangent vectors\index{separate!tangent
vectors}: for each closed point $P$, the set $\{s\in
V\,|\,s_P\in\frakm_P\scrL_P\}$ spans the cotangent space
$\frakm_P\scrL_P/\frakm_P^2\scrL_P$.
\end{enumerate}
\item An invertible sheaf $\scrL$ on a noetherian scheme is said to be
ample\index{ample} if for all coherent sheaves $\scrF$ there is an integer $n_0$
such that for $n\geq n_0$, $\scrF\otimes\scrL^{\otimes n}$ is g.b.g.s. Note that
`ample' is absolute, while `very ample' is relative.
\item \textbf{Proposition 7.5:}\indexThm{II.7.05}
For $\scrL$ an invertible sheaf on a noetherian scheme, $\scrL$ is ample \Iff
all positive tensor powers of $\scrL$ are ample \Iff some positive tensor power
of $\scrL$ is ample.
\item \textbf{Theorem 7.6:}\indexThm{II.7.06}
Let $X$ be a scheme of finite type over a noetherian ring $A$, and $\scrL$ an
invertible sheaf. The $\scrL$ is ample \Iff some power of $\scrL$ is very ample
over $\spec A$.
\item \textbf{Example 7.6.2:}\indexThm{II.7.06.2} The invertible sheaf of type
$(a,b)$ on $\PP^1\times\PP^1$ is very ample when $a,b>0$, using two uple
embeddings. It is not generated by global sections when either of $a$ or $b$ are
negative, so the ample sheaves coincide with the very ample sheaves.
\item Given an invertible sheaf $\scrL$ on $X$, and a section
$s\in\Gamma(X,\scrL)$, define an effective divisor $D=(s)_0$, the divisor of
zeros\index{divisor!of zeros} as follows. Over an open set where $\scrL$ is
trivial, choose an isomorphism $\phi:\scrL|_U\to\calO_U$, and take the effective
Cartier divisor $\{(U,\phi(s))\}$.
\item \textbf{Proposition 7.7:}\indexThm{II.7.07}
Let $X$ be a nonsigular projective variety over an algebraically closed field
$k$ (so that Weil and Cartier divisors are equivalent). For any divisor $D_0$
there is a bijection:
\[\xymatrix@R=.0cm{%@C=2cm{
\PP(\Gamma(X,\scrL))  \ar[r]&
\{\textup{effective divisors $D$}\,|\,D\sim D_0\}\makebox[0cm][l]{\,$=:|D_0|$}\\
[s] \ar@{|->}[r] & (s)_0
}\]
The sets $|D_0|$ are called complete linear systems\index{linear
system!complete} on $X$. A linear system\index{linear system} $\frakd$ is a
linear subspace of a complete linear system. Its dimension is its dimension as a
linear projective variety.
\item \textbf{No two points on an ellipic curve are linearly equivalent:} It is
the same to show that an intersection $\ell\cap C$ is only linearly equivalent
to other such intersections. [UMMM.. There's a SES:
\[\xymatrix{
0\ar[r]&
\calO_{\PP^2}(1)\ar[r]^{\cdot x}&
\calO_{\PP^2}(1)\ar[r]&
\calQ\ar[r]&
0
}\]
Now pullback is exact, so that ]
It can be shown that there's a surjection.
\[ H^{0}(X,\calO_{\PP^2}(1))\to H^{0}(C,\calO_{\PP^2}(1)|_{C}).\]
But $\ell\cap C$ is the divisor arising from the section of
$H^0(C,\calO_{\PP^2}(1)|_{C})$ given by the restriction of some linear form on
$\PP^2$ to $C$. So we are done.
\end{itemise}
\end{II.7 Projective Morphisms}

\printindex
\end{document}




suppose you have a finite (think relative dimension = 0) map $X\to Y$ of curves,
sending $x\mapsto y$. Then that induces a map $O_y\to O_x$ of local rings. If
$y$ is a smooth point, then $O_y$ is a DVR, so that every ideal of $O_y$ is a
power of the maximal one $m_y$. But you can map $m_x$ into $O_y$ and see what
power of $m_y$ it generates. If the power is one, the morphism is unramified at
$y$.

If $x$ is smooth, it's like: if you take a function at $y$ which vanishes to
order one, and pull it back to a function at $x$, you can ask what the order of
vanishing is there. It's unramified it that order of vanishing is one as well.










